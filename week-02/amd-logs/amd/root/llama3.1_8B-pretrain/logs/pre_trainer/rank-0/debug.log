[20251218 08:14:38][root/amd][pre_trainer][ip-10.21.9.25][rank-0/8][WARNING] [trainer.py:485]: MegatronTrainer: monkey patch TopKRouter...
[20251218 08:14:38][root/amd][pre_trainer][ip-10.21.9.25][rank-0/8][WARNING] [trainer.py:356]: MegatronTrainer: monkey patch get_extra_te_kwargs...
[20251218 08:14:38][root/amd][pre_trainer][ip-10.21.9.25][rank-0/8][WARNING] [trainer.py:588]: MegatronTrainer: Patching FileSystemWriterAsync...
[20251218 08:14:38][root/amd][pre_trainer][ip-10.21.9.25][rank-0/8][WARNING] [trainer.py:600]: MegatronTrainer: Patch FileSystemWriterAsync successfully.
[20251218 08:14:38][root/amd][pre_trainer][ip-10.21.9.25][rank-0/8][WARNING] [trainer.py:282]: MegatronTrainer: Patch get_fp8_context...
[20251218 08:14:38][root/amd][pre_trainer][ip-10.21.9.25][rank-0/8][INFO ] [---------trainer.py:694] : -run update_primus_config...
[20251218 08:14:38][root/amd][pre_trainer][ip-10.21.9.25][rank-0/8][INFO ] [---------trainer.py:810] : -rank:              0
[20251218 08:14:38][root/amd][pre_trainer][ip-10.21.9.25][rank-0/8][INFO ] [---------trainer.py:811] : -local_rank:        0
[20251218 08:14:38][root/amd][pre_trainer][ip-10.21.9.25][rank-0/8][INFO ] [---------trainer.py:812] : -world_size:        8
[20251218 08:14:38][root/amd][pre_trainer][ip-10.21.9.25][rank-0/8][INFO ] [---------trainer.py:829] : -save:              /workspace/Primus/output/amd/root/llama3.1_8B-pretrain/checkpoints
[20251218 08:14:38][root/amd][pre_trainer][ip-10.21.9.25][rank-0/8][INFO ] [---------trainer.py:836] : -auto_continue_train:False
[20251218 08:14:38][root/amd][pre_trainer][ip-10.21.9.25][rank-0/8][INFO ] [---------trainer.py:872] : -disable_tensorboard:True
[20251218 08:14:38][root/amd][pre_trainer][ip-10.21.9.25][rank-0/8][INFO ] [---------trainer.py:873] :   -tensorboard_dir: None
[20251218 08:14:38][root/amd][pre_trainer][ip-10.21.9.25][rank-0/8][DEBUG] [---------trainer.py:889] : args.wandb_project is disabled, as args.disable_wandb=True.
[20251218 08:14:38][root/amd][pre_trainer][ip-10.21.9.25][rank-0/8][INFO ] [---------trainer.py:890] : -disable_wandb:     True
[20251218 08:14:38][root/amd][pre_trainer][ip-10.21.9.25][rank-0/8][INFO ] [---------trainer.py:896] :   -wandb_project:   None
[20251218 08:14:38][root/amd][pre_trainer][ip-10.21.9.25][rank-0/8][INFO ] [---------trainer.py:897] :   -wandb_exp_name:  None
[20251218 08:14:38][root/amd][pre_trainer][ip-10.21.9.25][rank-0/8][INFO ] [---------trainer.py:898] :   -wandb_save_dir:  None
[20251218 08:14:38][root/amd][pre_trainer][ip-10.21.9.25][rank-0/8][INFO ] [---------trainer.py:899] :   -wandb_entity:    None
[20251218 08:14:38][root/amd][pre_trainer][ip-10.21.9.25][rank-0/8][INFO ] [---------trainer.py:902] : -disable_mlflow:    True
[20251218 08:14:38][root/amd][pre_trainer][ip-10.21.9.25][rank-0/8][INFO ] [---------trainer.py:916] :   -mlflow_run_name: None
[20251218 08:14:38][root/amd][pre_trainer][ip-10.21.9.25][rank-0/8][INFO ] [---------trainer.py:917] :   -mlflow_experiment_name:None
[20251218 08:14:38][root/amd][pre_trainer][ip-10.21.9.25][rank-0/8][INFO ] [-----import_utils.py:30] : [Primus][MegatronCompat] Loaded model_provider from model_provider
[20251218 08:14:38][root/amd][pre_trainer][ip-10.21.9.25][rank-0/8][INFO ] [-----import_utils.py:30] : [Primus][MegatronCompat] Loaded gpt_builder from gpt_builders
[20251218 08:14:38][root/amd][pre_trainer][ip-10.21.9.25][rank-0/8][INFO ] [---------trainer.py:702] : -run initialize_megatron...
[20251218 08:14:38][root/amd][pre_trainer][ip-10.21.9.25][rank-0/8][INFO ] [--------trainer.py:1158] : -load:              None
[20251218 08:14:38][root/amd][pre_trainer][ip-10.21.9.25][rank-0/8][INFO ] [--------trainer.py:1159] : -use_checkpoint_args:False
[20251218 08:14:38][root/amd][pre_trainer][ip-10.21.9.25][rank-0/8][DEBUG] [-------arguments.py:416] : using world size: 8, data-parallel size: 8, context-parallel size: 1, hierarchical context-parallel sizes: None, tensor-model-parallel size: 1, pipeline-model-parallel size: 1
[20251218 08:14:38][root/amd][pre_trainer][ip-10.21.9.25][rank-0/8][DEBUG] [-------arguments.py:598] : Number of virtual stages per pipeline stage: None
[20251218 08:14:38][root/amd][pre_trainer][ip-10.21.9.25][rank-0/8][DEBUG] [-------arguments.py:722] : accumulate and all-reduce gradients in fp32 for bfloat16 data type.
[20251218 08:14:38][root/amd][pre_trainer][ip-10.21.9.25][rank-0/8][DEBUG] [-------arguments.py:733] : using torch.bfloat16 for parameters ...
[20251218 08:14:38][root/amd][pre_trainer][ip-10.21.9.25][rank-0/8][DEBUG] [------arguments.py:1191] : ------------------------ arguments ------------------------
[20251218 08:14:38][root/amd][pre_trainer][ip-10.21.9.25][rank-0/8][DEBUG] [------arguments.py:1198] :   account_for_embedding_in_pipeline_split ......... False
[20251218 08:14:38][root/amd][pre_trainer][ip-10.21.9.25][rank-0/8][DEBUG] [------arguments.py:1198] :   account_for_loss_in_pipeline_split .............. False
[20251218 08:14:38][root/amd][pre_trainer][ip-10.21.9.25][rank-0/8][DEBUG] [------arguments.py:1198] :   accumulate_allreduce_grads_in_fp32 .............. True
[20251218 08:14:38][root/amd][pre_trainer][ip-10.21.9.25][rank-0/8][DEBUG] [------arguments.py:1198] :   adam_beta1 ...................................... 0.9
[20251218 08:14:38][root/amd][pre_trainer][ip-10.21.9.25][rank-0/8][DEBUG] [------arguments.py:1198] :   adam_beta2 ...................................... 0.95
[20251218 08:14:38][root/amd][pre_trainer][ip-10.21.9.25][rank-0/8][DEBUG] [------arguments.py:1198] :   adam_eps ........................................ 1e-08
[20251218 08:14:38][root/amd][pre_trainer][ip-10.21.9.25][rank-0/8][DEBUG] [------arguments.py:1198] :   add_bias_linear ................................. False
[20251218 08:14:38][root/amd][pre_trainer][ip-10.21.9.25][rank-0/8][DEBUG] [------arguments.py:1198] :   add_position_embedding .......................... False
[20251218 08:14:38][root/amd][pre_trainer][ip-10.21.9.25][rank-0/8][DEBUG] [------arguments.py:1198] :   add_qkv_bias .................................... False
[20251218 08:14:38][root/amd][pre_trainer][ip-10.21.9.25][rank-0/8][DEBUG] [------arguments.py:1198] :   adlr_autoresume ................................. False
[20251218 08:14:38][root/amd][pre_trainer][ip-10.21.9.25][rank-0/8][DEBUG] [------arguments.py:1198] :   adlr_autoresume_interval ........................ 1000
[20251218 08:14:38][root/amd][pre_trainer][ip-10.21.9.25][rank-0/8][DEBUG] [------arguments.py:1198] :   align_grad_reduce ............................... True
[20251218 08:14:38][root/amd][pre_trainer][ip-10.21.9.25][rank-0/8][DEBUG] [------arguments.py:1198] :   align_param_gather .............................. False
[20251218 08:14:38][root/amd][pre_trainer][ip-10.21.9.25][rank-0/8][DEBUG] [------arguments.py:1198] :   allow_padding_num_layers ........................ True
[20251218 08:14:38][root/amd][pre_trainer][ip-10.21.9.25][rank-0/8][DEBUG] [------arguments.py:1198] :   app_tag_run_name ................................ None
[20251218 08:14:38][root/amd][pre_trainer][ip-10.21.9.25][rank-0/8][DEBUG] [------arguments.py:1198] :   app_tag_run_version ............................. 0.0.0
[20251218 08:14:38][root/amd][pre_trainer][ip-10.21.9.25][rank-0/8][DEBUG] [------arguments.py:1198] :   apply_layernorm_1p .............................. False
[20251218 08:14:38][root/amd][pre_trainer][ip-10.21.9.25][rank-0/8][DEBUG] [------arguments.py:1198] :   apply_query_key_layer_scaling ................... False
[20251218 08:14:38][root/amd][pre_trainer][ip-10.21.9.25][rank-0/8][DEBUG] [------arguments.py:1198] :   apply_residual_connection_post_layernorm ........ False
[20251218 08:14:38][root/amd][pre_trainer][ip-10.21.9.25][rank-0/8][DEBUG] [------arguments.py:1198] :   apply_rope_fusion ............................... True
[20251218 08:14:38][root/amd][pre_trainer][ip-10.21.9.25][rank-0/8][DEBUG] [------arguments.py:1198] :   async_save ...................................... None
[20251218 08:14:38][root/amd][pre_trainer][ip-10.21.9.25][rank-0/8][DEBUG] [------arguments.py:1198] :   async_tensor_model_parallel_allreduce ........... True
[20251218 08:14:38][root/amd][pre_trainer][ip-10.21.9.25][rank-0/8][DEBUG] [------arguments.py:1198] :   attention_backend ............................... auto
[20251218 08:14:38][root/amd][pre_trainer][ip-10.21.9.25][rank-0/8][DEBUG] [------arguments.py:1198] :   attention_dropout ............................... 0.0
[20251218 08:14:38][root/amd][pre_trainer][ip-10.21.9.25][rank-0/8][DEBUG] [------arguments.py:1198] :   attention_softmax_in_fp32 ....................... True
[20251218 08:14:38][root/amd][pre_trainer][ip-10.21.9.25][rank-0/8][DEBUG] [------arguments.py:1198] :   attn_logit_softcapping .......................... None
[20251218 08:14:38][root/amd][pre_trainer][ip-10.21.9.25][rank-0/8][DEBUG] [------arguments.py:1198] :   auto_continue_train ............................. False
[20251218 08:14:38][root/amd][pre_trainer][ip-10.21.9.25][rank-0/8][DEBUG] [------arguments.py:1198] :   auto_detect_ckpt_format ......................... False
[20251218 08:14:38][root/amd][pre_trainer][ip-10.21.9.25][rank-0/8][DEBUG] [------arguments.py:1198] :   auto_offload_time ............................... True
[20251218 08:14:38][root/amd][pre_trainer][ip-10.21.9.25][rank-0/8][DEBUG] [------arguments.py:1198] :   barrier_with_L1_time ............................ True
[20251218 08:14:38][root/amd][pre_trainer][ip-10.21.9.25][rank-0/8][DEBUG] [------arguments.py:1198] :   bert_binary_head ................................ True
[20251218 08:14:38][root/amd][pre_trainer][ip-10.21.9.25][rank-0/8][DEBUG] [------arguments.py:1198] :   bert_embedder_type .............................. megatron
[20251218 08:14:38][root/amd][pre_trainer][ip-10.21.9.25][rank-0/8][DEBUG] [------arguments.py:1198] :   bert_load ....................................... None
[20251218 08:14:38][root/amd][pre_trainer][ip-10.21.9.25][rank-0/8][DEBUG] [------arguments.py:1198] :   bf16 ............................................ True
[20251218 08:14:38][root/amd][pre_trainer][ip-10.21.9.25][rank-0/8][DEBUG] [------arguments.py:1198] :   bias_dropout_fusion ............................. True
[20251218 08:14:38][root/amd][pre_trainer][ip-10.21.9.25][rank-0/8][DEBUG] [------arguments.py:1198] :   bias_gelu_fusion ................................ False
[20251218 08:14:38][root/amd][pre_trainer][ip-10.21.9.25][rank-0/8][DEBUG] [------arguments.py:1198] :   bias_swiglu_fusion .............................. True
[20251218 08:14:38][root/amd][pre_trainer][ip-10.21.9.25][rank-0/8][DEBUG] [------arguments.py:1198] :   biencoder_projection_dim ........................ 0
[20251218 08:14:38][root/amd][pre_trainer][ip-10.21.9.25][rank-0/8][DEBUG] [------arguments.py:1198] :   biencoder_shared_query_context_model ............ False
[20251218 08:14:38][root/amd][pre_trainer][ip-10.21.9.25][rank-0/8][DEBUG] [------arguments.py:1198] :   block_data_path ................................. None
[20251218 08:14:38][root/amd][pre_trainer][ip-10.21.9.25][rank-0/8][DEBUG] [------arguments.py:1198] :   calc_ft_timeouts ................................ False
[20251218 08:14:38][root/amd][pre_trainer][ip-10.21.9.25][rank-0/8][DEBUG] [------arguments.py:1198] :   calculate_per_token_loss ........................ False
[20251218 08:14:38][root/amd][pre_trainer][ip-10.21.9.25][rank-0/8][DEBUG] [------arguments.py:1198] :   check_for_large_grads ........................... False
[20251218 08:14:38][root/amd][pre_trainer][ip-10.21.9.25][rank-0/8][DEBUG] [------arguments.py:1198] :   check_for_nan_in_loss_and_grad .................. True
[20251218 08:14:38][root/amd][pre_trainer][ip-10.21.9.25][rank-0/8][DEBUG] [------arguments.py:1198] :   check_for_spiky_loss ............................ False
[20251218 08:14:38][root/amd][pre_trainer][ip-10.21.9.25][rank-0/8][DEBUG] [------arguments.py:1198] :   check_weight_hash_across_dp_replicas_interval ... None
[20251218 08:14:38][root/amd][pre_trainer][ip-10.21.9.25][rank-0/8][DEBUG] [------arguments.py:1198] :   ckpt_assume_constant_structure .................. False
[20251218 08:14:38][root/amd][pre_trainer][ip-10.21.9.25][rank-0/8][DEBUG] [------arguments.py:1198] :   ckpt_convert_format ............................. None
[20251218 08:14:38][root/amd][pre_trainer][ip-10.21.9.25][rank-0/8][DEBUG] [------arguments.py:1198] :   ckpt_convert_save ............................... None
[20251218 08:14:38][root/amd][pre_trainer][ip-10.21.9.25][rank-0/8][DEBUG] [------arguments.py:1198] :   ckpt_convert_update_legacy_dist_opt_format ...... False
[20251218 08:14:38][root/amd][pre_trainer][ip-10.21.9.25][rank-0/8][DEBUG] [------arguments.py:1198] :   ckpt_format ..................................... torch
[20251218 08:14:38][root/amd][pre_trainer][ip-10.21.9.25][rank-0/8][DEBUG] [------arguments.py:1198] :   ckpt_fully_parallel_load ........................ False
[20251218 08:14:38][root/amd][pre_trainer][ip-10.21.9.25][rank-0/8][DEBUG] [------arguments.py:1198] :   ckpt_fully_parallel_save ........................ True
[20251218 08:14:38][root/amd][pre_trainer][ip-10.21.9.25][rank-0/8][DEBUG] [------arguments.py:1198] :   ckpt_fully_parallel_save_deprecated ............. False
[20251218 08:14:38][root/amd][pre_trainer][ip-10.21.9.25][rank-0/8][DEBUG] [------arguments.py:1198] :   ckpt_step ....................................... None
[20251218 08:14:38][root/amd][pre_trainer][ip-10.21.9.25][rank-0/8][DEBUG] [------arguments.py:1198] :   classes_fraction ................................ 1.0
[20251218 08:14:38][root/amd][pre_trainer][ip-10.21.9.25][rank-0/8][DEBUG] [------arguments.py:1198] :   clip_grad ....................................... 1.0
[20251218 08:14:38][root/amd][pre_trainer][ip-10.21.9.25][rank-0/8][DEBUG] [------arguments.py:1198] :   clone_scatter_output_in_embedding ............... True
[20251218 08:14:38][root/amd][pre_trainer][ip-10.21.9.25][rank-0/8][DEBUG] [------arguments.py:1198] :   config_logger_dir ............................... 
[20251218 08:14:38][root/amd][pre_trainer][ip-10.21.9.25][rank-0/8][DEBUG] [------arguments.py:1198] :   consumed_train_samples .......................... 0
[20251218 08:14:38][root/amd][pre_trainer][ip-10.21.9.25][rank-0/8][DEBUG] [------arguments.py:1198] :   consumed_valid_samples .......................... 0
[20251218 08:14:38][root/amd][pre_trainer][ip-10.21.9.25][rank-0/8][DEBUG] [------arguments.py:1198] :   context_parallel_size ........................... 1
[20251218 08:14:38][root/amd][pre_trainer][ip-10.21.9.25][rank-0/8][DEBUG] [------arguments.py:1198] :   cp_comm_type .................................... p2p
[20251218 08:14:38][root/amd][pre_trainer][ip-10.21.9.25][rank-0/8][DEBUG] [------arguments.py:1198] :   cpu_offload ..................................... False
[20251218 08:14:38][root/amd][pre_trainer][ip-10.21.9.25][rank-0/8][DEBUG] [------arguments.py:1198] :   create_attention_mask_in_dataloader ............. True
[20251218 08:14:38][root/amd][pre_trainer][ip-10.21.9.25][rank-0/8][DEBUG] [------arguments.py:1198] :   cross_entropy_fusion_impl ....................... native
[20251218 08:14:38][root/amd][pre_trainer][ip-10.21.9.25][rank-0/8][DEBUG] [------arguments.py:1198] :   cross_entropy_loss_fusion ....................... False
[20251218 08:14:38][root/amd][pre_trainer][ip-10.21.9.25][rank-0/8][DEBUG] [------arguments.py:1198] :   cuda_graph_scope ................................ full
[20251218 08:14:38][root/amd][pre_trainer][ip-10.21.9.25][rank-0/8][DEBUG] [------arguments.py:1198] :   cuda_graph_warmup_steps ......................... 3
[20251218 08:14:38][root/amd][pre_trainer][ip-10.21.9.25][rank-0/8][DEBUG] [------arguments.py:1198] :   data_args_path .................................. None
[20251218 08:14:38][root/amd][pre_trainer][ip-10.21.9.25][rank-0/8][DEBUG] [------arguments.py:1198] :   data_cache_path ................................. None
[20251218 08:14:38][root/amd][pre_trainer][ip-10.21.9.25][rank-0/8][DEBUG] [------arguments.py:1198] :   data_parallel_random_init ....................... False
[20251218 08:14:38][root/amd][pre_trainer][ip-10.21.9.25][rank-0/8][DEBUG] [------arguments.py:1198] :   data_parallel_sharding_strategy ................. no_shard
[20251218 08:14:38][root/amd][pre_trainer][ip-10.21.9.25][rank-0/8][DEBUG] [------arguments.py:1198] :   data_parallel_size .............................. 8
[20251218 08:14:38][root/amd][pre_trainer][ip-10.21.9.25][rank-0/8][DEBUG] [------arguments.py:1198] :   data_path ....................................... None
[20251218 08:14:38][root/amd][pre_trainer][ip-10.21.9.25][rank-0/8][DEBUG] [------arguments.py:1198] :   data_per_class_fraction ......................... 1.0
[20251218 08:14:38][root/amd][pre_trainer][ip-10.21.9.25][rank-0/8][DEBUG] [------arguments.py:1198] :   data_sharding ................................... True
[20251218 08:14:38][root/amd][pre_trainer][ip-10.21.9.25][rank-0/8][DEBUG] [------arguments.py:1198] :   dataloader_type ................................. cyclic
[20251218 08:14:38][root/amd][pre_trainer][ip-10.21.9.25][rank-0/8][DEBUG] [------arguments.py:1198] :   ddp_average_in_collective ....................... False
[20251218 08:14:38][root/amd][pre_trainer][ip-10.21.9.25][rank-0/8][DEBUG] [------arguments.py:1198] :   ddp_bucket_size ................................. None
[20251218 08:14:38][root/amd][pre_trainer][ip-10.21.9.25][rank-0/8][DEBUG] [------arguments.py:1198] :   ddp_num_buckets ................................. None
[20251218 08:14:38][root/amd][pre_trainer][ip-10.21.9.25][rank-0/8][DEBUG] [------arguments.py:1198] :   ddp_pad_buckets_for_high_nccl_busbw ............. False
[20251218 08:14:38][root/amd][pre_trainer][ip-10.21.9.25][rank-0/8][DEBUG] [------arguments.py:1198] :   debug_scheduler_table ........................... False
[20251218 08:14:38][root/amd][pre_trainer][ip-10.21.9.25][rank-0/8][DEBUG] [------arguments.py:1198] :   decoder_first_pipeline_num_layers ............... None
[20251218 08:14:38][root/amd][pre_trainer][ip-10.21.9.25][rank-0/8][DEBUG] [------arguments.py:1198] :   decoder_last_pipeline_num_layers ................ None
[20251218 08:14:38][root/amd][pre_trainer][ip-10.21.9.25][rank-0/8][DEBUG] [------arguments.py:1198] :   decoder_num_layers .............................. None
[20251218 08:14:38][root/amd][pre_trainer][ip-10.21.9.25][rank-0/8][DEBUG] [------arguments.py:1198] :   decoder_pipeline_manual_split_list .............. None
[20251218 08:14:38][root/amd][pre_trainer][ip-10.21.9.25][rank-0/8][DEBUG] [------arguments.py:1198] :   decoder_seq_length .............................. None
[20251218 08:14:38][root/amd][pre_trainer][ip-10.21.9.25][rank-0/8][DEBUG] [------arguments.py:1198] :   decoupled_lr .................................... None
[20251218 08:14:38][root/amd][pre_trainer][ip-10.21.9.25][rank-0/8][DEBUG] [------arguments.py:1198] :   decoupled_min_lr ................................ None
[20251218 08:14:38][root/amd][pre_trainer][ip-10.21.9.25][rank-0/8][DEBUG] [------arguments.py:1198] :   decrease_batch_size_if_needed ................... False
[20251218 08:14:38][root/amd][pre_trainer][ip-10.21.9.25][rank-0/8][DEBUG] [------arguments.py:1198] :   defer_embedding_wgrad_compute ................... False
[20251218 08:14:38][root/amd][pre_trainer][ip-10.21.9.25][rank-0/8][DEBUG] [------arguments.py:1198] :   delay_wgrad_compute ............................. False
[20251218 08:14:38][root/amd][pre_trainer][ip-10.21.9.25][rank-0/8][DEBUG] [------arguments.py:1198] :   deprecated_use_mcore_models ..................... False
[20251218 08:14:38][root/amd][pre_trainer][ip-10.21.9.25][rank-0/8][DEBUG] [------arguments.py:1198] :   deterministic_mode .............................. False
[20251218 08:14:38][root/amd][pre_trainer][ip-10.21.9.25][rank-0/8][DEBUG] [------arguments.py:1198] :   dino_bottleneck_size ............................ 256
[20251218 08:14:38][root/amd][pre_trainer][ip-10.21.9.25][rank-0/8][DEBUG] [------arguments.py:1198] :   dino_freeze_last_layer .......................... 1
[20251218 08:14:38][root/amd][pre_trainer][ip-10.21.9.25][rank-0/8][DEBUG] [------arguments.py:1198] :   dino_head_hidden_size ........................... 2048
[20251218 08:14:38][root/amd][pre_trainer][ip-10.21.9.25][rank-0/8][DEBUG] [------arguments.py:1198] :   dino_local_crops_number ......................... 10
[20251218 08:14:38][root/amd][pre_trainer][ip-10.21.9.25][rank-0/8][DEBUG] [------arguments.py:1198] :   dino_local_img_size ............................. 96
[20251218 08:14:38][root/amd][pre_trainer][ip-10.21.9.25][rank-0/8][DEBUG] [------arguments.py:1198] :   dino_norm_last_layer ............................ False
[20251218 08:14:38][root/amd][pre_trainer][ip-10.21.9.25][rank-0/8][DEBUG] [------arguments.py:1198] :   dino_teacher_temp ............................... 0.07
[20251218 08:14:38][root/amd][pre_trainer][ip-10.21.9.25][rank-0/8][DEBUG] [------arguments.py:1198] :   dino_warmup_teacher_temp ........................ 0.04
[20251218 08:14:38][root/amd][pre_trainer][ip-10.21.9.25][rank-0/8][DEBUG] [------arguments.py:1198] :   dino_warmup_teacher_temp_epochs ................. 30
[20251218 08:14:38][root/amd][pre_trainer][ip-10.21.9.25][rank-0/8][DEBUG] [------arguments.py:1198] :   disable_compile_dependencies .................... True
[20251218 08:14:38][root/amd][pre_trainer][ip-10.21.9.25][rank-0/8][DEBUG] [------arguments.py:1198] :   disable_last_saving ............................. True
[20251218 08:14:38][root/amd][pre_trainer][ip-10.21.9.25][rank-0/8][DEBUG] [------arguments.py:1198] :   disable_mamba_mem_eff_path ...................... False
[20251218 08:14:38][root/amd][pre_trainer][ip-10.21.9.25][rank-0/8][DEBUG] [------arguments.py:1198] :   disable_mlflow .................................. True
[20251218 08:14:38][root/amd][pre_trainer][ip-10.21.9.25][rank-0/8][DEBUG] [------arguments.py:1198] :   disable_primus_topk_router ...................... False
[20251218 08:14:38][root/amd][pre_trainer][ip-10.21.9.25][rank-0/8][DEBUG] [------arguments.py:1198] :   disable_profiler_activity_cpu ................... False
[20251218 08:14:38][root/amd][pre_trainer][ip-10.21.9.25][rank-0/8][DEBUG] [------arguments.py:1198] :   disable_straggler_on_startup .................... False
[20251218 08:14:38][root/amd][pre_trainer][ip-10.21.9.25][rank-0/8][DEBUG] [------arguments.py:1198] :   disable_tensorboard ............................. True
[20251218 08:14:38][root/amd][pre_trainer][ip-10.21.9.25][rank-0/8][DEBUG] [------arguments.py:1198] :   disable_wandb ................................... True
[20251218 08:14:38][root/amd][pre_trainer][ip-10.21.9.25][rank-0/8][DEBUG] [------arguments.py:1198] :   dist_ckpt_format_deprecated ..................... None
[20251218 08:14:38][root/amd][pre_trainer][ip-10.21.9.25][rank-0/8][DEBUG] [------arguments.py:1198] :   dist_ckpt_optim_fully_reshardable ............... None
[20251218 08:14:38][root/amd][pre_trainer][ip-10.21.9.25][rank-0/8][DEBUG] [------arguments.py:1198] :   dist_ckpt_save_pre_mcore_014 .................... None
[20251218 08:14:38][root/amd][pre_trainer][ip-10.21.9.25][rank-0/8][DEBUG] [------arguments.py:1198] :   dist_ckpt_strictness ............................ assume_ok_unexpected
[20251218 08:14:38][root/amd][pre_trainer][ip-10.21.9.25][rank-0/8][DEBUG] [------arguments.py:1198] :   distribute_saved_activations .................... False
[20251218 08:14:38][root/amd][pre_trainer][ip-10.21.9.25][rank-0/8][DEBUG] [------arguments.py:1198] :   distributed_backend ............................. nccl
[20251218 08:14:38][root/amd][pre_trainer][ip-10.21.9.25][rank-0/8][DEBUG] [------arguments.py:1198] :   distributed_timeout_minutes ..................... 60
[20251218 08:14:38][root/amd][pre_trainer][ip-10.21.9.25][rank-0/8][DEBUG] [------arguments.py:1198] :   dump_pp_data .................................... False
[20251218 08:14:38][root/amd][pre_trainer][ip-10.21.9.25][rank-0/8][DEBUG] [------arguments.py:1198] :   embedding_path .................................. None
[20251218 08:14:38][root/amd][pre_trainer][ip-10.21.9.25][rank-0/8][DEBUG] [------arguments.py:1198] :   empty_unused_memory_level ....................... 0
[20251218 08:14:38][root/amd][pre_trainer][ip-10.21.9.25][rank-0/8][DEBUG] [------arguments.py:1198] :   enable_1f1b_v ................................... False
[20251218 08:14:38][root/amd][pre_trainer][ip-10.21.9.25][rank-0/8][DEBUG] [------arguments.py:1198] :   enable_cuda_graph ............................... False
[20251218 08:14:38][root/amd][pre_trainer][ip-10.21.9.25][rank-0/8][DEBUG] [------arguments.py:1198] :   enable_exactly_numeric_match .................... True
[20251218 08:14:38][root/amd][pre_trainer][ip-10.21.9.25][rank-0/8][DEBUG] [------arguments.py:1198] :   enable_experimental ............................. False
[20251218 08:14:38][root/amd][pre_trainer][ip-10.21.9.25][rank-0/8][DEBUG] [------arguments.py:1198] :   enable_ft_package ............................... False
[20251218 08:14:38][root/amd][pre_trainer][ip-10.21.9.25][rank-0/8][DEBUG] [------arguments.py:1198] :   enable_gloo_process_groups ...................... True
[20251218 08:14:38][root/amd][pre_trainer][ip-10.21.9.25][rank-0/8][DEBUG] [------arguments.py:1198] :   enable_one_logger ............................... True
[20251218 08:14:38][root/amd][pre_trainer][ip-10.21.9.25][rank-0/8][DEBUG] [------arguments.py:1198] :   enable_optimizer_post_validation ................ False
[20251218 08:14:38][root/amd][pre_trainer][ip-10.21.9.25][rank-0/8][DEBUG] [------arguments.py:1198] :   enable_primus_turbo ............................. True
[20251218 08:14:38][root/amd][pre_trainer][ip-10.21.9.25][rank-0/8][DEBUG] [------arguments.py:1198] :   enable_turbo_attention_float8 ................... False
[20251218 08:14:38][root/amd][pre_trainer][ip-10.21.9.25][rank-0/8][DEBUG] [------arguments.py:1198] :   enable_zb_runtime ............................... True
[20251218 08:14:38][root/amd][pre_trainer][ip-10.21.9.25][rank-0/8][DEBUG] [------arguments.py:1198] :   enable_zero_bubble .............................. True
[20251218 08:14:38][root/amd][pre_trainer][ip-10.21.9.25][rank-0/8][DEBUG] [------arguments.py:1198] :   encoder_num_layers .............................. 32
[20251218 08:14:38][root/amd][pre_trainer][ip-10.21.9.25][rank-0/8][DEBUG] [------arguments.py:1198] :   encoder_pipeline_model_parallel_size ............ 0
[20251218 08:14:38][root/amd][pre_trainer][ip-10.21.9.25][rank-0/8][DEBUG] [------arguments.py:1198] :   encoder_seq_length .............................. 8192
[20251218 08:14:38][root/amd][pre_trainer][ip-10.21.9.25][rank-0/8][DEBUG] [------arguments.py:1198] :   encoder_tensor_model_parallel_size .............. 0
[20251218 08:14:38][root/amd][pre_trainer][ip-10.21.9.25][rank-0/8][DEBUG] [------arguments.py:1198] :   end_weight_decay ................................ 0.1
[20251218 08:14:38][root/amd][pre_trainer][ip-10.21.9.25][rank-0/8][DEBUG] [------arguments.py:1198] :   eod_mask_loss ................................... True
[20251218 08:14:38][root/amd][pre_trainer][ip-10.21.9.25][rank-0/8][DEBUG] [------arguments.py:1198] :   error_injection_rate ............................ 0
[20251218 08:14:38][root/amd][pre_trainer][ip-10.21.9.25][rank-0/8][DEBUG] [------arguments.py:1198] :   error_injection_type ............................ transient_error
[20251218 08:14:38][root/amd][pre_trainer][ip-10.21.9.25][rank-0/8][DEBUG] [------arguments.py:1198] :   eval_interval ................................... 1000
[20251218 08:14:38][root/amd][pre_trainer][ip-10.21.9.25][rank-0/8][DEBUG] [------arguments.py:1198] :   eval_iters ...................................... 0
[20251218 08:14:38][root/amd][pre_trainer][ip-10.21.9.25][rank-0/8][DEBUG] [------arguments.py:1198] :   evidence_data_path .............................. None
[20251218 08:14:38][root/amd][pre_trainer][ip-10.21.9.25][rank-0/8][DEBUG] [------arguments.py:1198] :   exit_duration_in_mins ........................... None
[20251218 08:14:38][root/amd][pre_trainer][ip-10.21.9.25][rank-0/8][DEBUG] [------arguments.py:1198] :   exit_interval ................................... None
[20251218 08:14:38][root/amd][pre_trainer][ip-10.21.9.25][rank-0/8][DEBUG] [------arguments.py:1198] :   exit_on_missing_checkpoint ...................... True
[20251218 08:14:38][root/amd][pre_trainer][ip-10.21.9.25][rank-0/8][DEBUG] [------arguments.py:1198] :   exit_signal_handler ............................. False
[20251218 08:14:38][root/amd][pre_trainer][ip-10.21.9.25][rank-0/8][DEBUG] [------arguments.py:1198] :   exp_avg_dtype ................................... torch.float32
[20251218 08:14:38][root/amd][pre_trainer][ip-10.21.9.25][rank-0/8][DEBUG] [------arguments.py:1198] :   exp_avg_sq_dtype ................................ torch.float32
[20251218 08:14:38][root/amd][pre_trainer][ip-10.21.9.25][rank-0/8][DEBUG] [------arguments.py:1198] :   expert_model_parallel_size ...................... 1
[20251218 08:14:38][root/amd][pre_trainer][ip-10.21.9.25][rank-0/8][DEBUG] [------arguments.py:1198] :   expert_tensor_parallel_size ..................... 1
[20251218 08:14:38][root/amd][pre_trainer][ip-10.21.9.25][rank-0/8][DEBUG] [------arguments.py:1198] :   external_cuda_graph ............................. False
[20251218 08:14:38][root/amd][pre_trainer][ip-10.21.9.25][rank-0/8][DEBUG] [------arguments.py:1198] :   ffn_hidden_size ................................. 14336
[20251218 08:14:38][root/amd][pre_trainer][ip-10.21.9.25][rank-0/8][DEBUG] [------arguments.py:1198] :   file_sink_level ................................. DEBUG
[20251218 08:14:38][root/amd][pre_trainer][ip-10.21.9.25][rank-0/8][DEBUG] [------arguments.py:1198] :   final_logit_softcapping ......................... None
[20251218 08:14:38][root/amd][pre_trainer][ip-10.21.9.25][rank-0/8][DEBUG] [------arguments.py:1198] :   finetune ........................................ False
[20251218 08:14:38][root/amd][pre_trainer][ip-10.21.9.25][rank-0/8][DEBUG] [------arguments.py:1198] :   first_last_layers_bf16 .......................... False
[20251218 08:14:38][root/amd][pre_trainer][ip-10.21.9.25][rank-0/8][DEBUG] [------arguments.py:1198] :   flash_decode .................................... False
[20251218 08:14:38][root/amd][pre_trainer][ip-10.21.9.25][rank-0/8][DEBUG] [------arguments.py:1198] :   fp16 ............................................ False
[20251218 08:14:38][root/amd][pre_trainer][ip-10.21.9.25][rank-0/8][DEBUG] [------arguments.py:1198] :   fp16_lm_cross_entropy ........................... False
[20251218 08:14:38][root/amd][pre_trainer][ip-10.21.9.25][rank-0/8][DEBUG] [------arguments.py:1198] :   fp32_residual_connection ........................ False
[20251218 08:14:38][root/amd][pre_trainer][ip-10.21.9.25][rank-0/8][DEBUG] [------arguments.py:1198] :   fp4 ............................................. None
[20251218 08:14:38][root/amd][pre_trainer][ip-10.21.9.25][rank-0/8][DEBUG] [------arguments.py:1198] :   fp4_param ....................................... False
[20251218 08:14:38][root/amd][pre_trainer][ip-10.21.9.25][rank-0/8][DEBUG] [------arguments.py:1198] :   fp4_recipe ...................................... nvfp4
[20251218 08:14:38][root/amd][pre_trainer][ip-10.21.9.25][rank-0/8][DEBUG] [------arguments.py:1198] :   fp8 ............................................. hybrid
[20251218 08:14:38][root/amd][pre_trainer][ip-10.21.9.25][rank-0/8][DEBUG] [------arguments.py:1198] :   fp8_amax_compute_algo ........................... max
[20251218 08:14:38][root/amd][pre_trainer][ip-10.21.9.25][rank-0/8][DEBUG] [------arguments.py:1198] :   fp8_amax_history_len ............................ 1024
[20251218 08:14:38][root/amd][pre_trainer][ip-10.21.9.25][rank-0/8][DEBUG] [------arguments.py:1198] :   fp8_interval .................................... 1
[20251218 08:14:38][root/amd][pre_trainer][ip-10.21.9.25][rank-0/8][DEBUG] [------arguments.py:1198] :   fp8_margin ...................................... 0
[20251218 08:14:38][root/amd][pre_trainer][ip-10.21.9.25][rank-0/8][DEBUG] [------arguments.py:1198] :   fp8_param_gather ................................ False
[20251218 08:14:38][root/amd][pre_trainer][ip-10.21.9.25][rank-0/8][DEBUG] [------arguments.py:1198] :   fp8_recipe ...................................... delayed
[20251218 08:14:38][root/amd][pre_trainer][ip-10.21.9.25][rank-0/8][DEBUG] [------arguments.py:1198] :   fp8_wgrad ....................................... True
[20251218 08:14:38][root/amd][pre_trainer][ip-10.21.9.25][rank-0/8][DEBUG] [------arguments.py:1198] :   framework ....................................... megatron
[20251218 08:14:38][root/amd][pre_trainer][ip-10.21.9.25][rank-0/8][DEBUG] [------arguments.py:1198] :   full_validation ................................. False
[20251218 08:14:38][root/amd][pre_trainer][ip-10.21.9.25][rank-0/8][DEBUG] [------arguments.py:1198] :   fused_padded_mla_attention ...................... False
[20251218 08:14:38][root/amd][pre_trainer][ip-10.21.9.25][rank-0/8][DEBUG] [------arguments.py:1198] :   global_batch_size ............................... 256
[20251218 08:14:38][root/amd][pre_trainer][ip-10.21.9.25][rank-0/8][DEBUG] [------arguments.py:1198] :   grad_reduce_in_bf16 ............................. False
[20251218 08:14:38][root/amd][pre_trainer][ip-10.21.9.25][rank-0/8][DEBUG] [------arguments.py:1198] :   gradient_accumulation_fusion .................... False
[20251218 08:14:38][root/amd][pre_trainer][ip-10.21.9.25][rank-0/8][DEBUG] [------arguments.py:1198] :   gradient_reduce_div_fusion ...................... True
[20251218 08:14:38][root/amd][pre_trainer][ip-10.21.9.25][rank-0/8][DEBUG] [------arguments.py:1198] :   group_query_attention ........................... True
[20251218 08:14:38][root/amd][pre_trainer][ip-10.21.9.25][rank-0/8][DEBUG] [------arguments.py:1198] :   grpo_clamp_eps_lower ............................ 0.01
[20251218 08:14:38][root/amd][pre_trainer][ip-10.21.9.25][rank-0/8][DEBUG] [------arguments.py:1198] :   grpo_clamp_eps_upper ............................ 0.01
[20251218 08:14:38][root/amd][pre_trainer][ip-10.21.9.25][rank-0/8][DEBUG] [------arguments.py:1198] :   grpo_default_temperature ........................ 1.0
[20251218 08:14:38][root/amd][pre_trainer][ip-10.21.9.25][rank-0/8][DEBUG] [------arguments.py:1198] :   grpo_default_top_p .............................. 0
[20251218 08:14:38][root/amd][pre_trainer][ip-10.21.9.25][rank-0/8][DEBUG] [------arguments.py:1198] :   grpo_entropy_term_weight ........................ 0.0
[20251218 08:14:38][root/amd][pre_trainer][ip-10.21.9.25][rank-0/8][DEBUG] [------arguments.py:1198] :   grpo_filter_groups_with_same_reward ............. False
[20251218 08:14:38][root/amd][pre_trainer][ip-10.21.9.25][rank-0/8][DEBUG] [------arguments.py:1198] :   grpo_group_size ................................. 2
[20251218 08:14:38][root/amd][pre_trainer][ip-10.21.9.25][rank-0/8][DEBUG] [------arguments.py:1198] :   grpo_iterations ................................. 2
[20251218 08:14:38][root/amd][pre_trainer][ip-10.21.9.25][rank-0/8][DEBUG] [------arguments.py:1198] :   grpo_kl_beta .................................... 0.001
[20251218 08:14:38][root/amd][pre_trainer][ip-10.21.9.25][rank-0/8][DEBUG] [------arguments.py:1198] :   grpo_prompts_per_step ........................... 32
[20251218 08:14:38][root/amd][pre_trainer][ip-10.21.9.25][rank-0/8][DEBUG] [------arguments.py:1198] :   head_lr_mult .................................... 1.0
[20251218 08:14:38][root/amd][pre_trainer][ip-10.21.9.25][rank-0/8][DEBUG] [------arguments.py:1198] :   heterogeneous_layers_config_encoded_json ........ None
[20251218 08:14:38][root/amd][pre_trainer][ip-10.21.9.25][rank-0/8][DEBUG] [------arguments.py:1198] :   heterogeneous_layers_config_path ................ None
[20251218 08:14:38][root/amd][pre_trainer][ip-10.21.9.25][rank-0/8][DEBUG] [------arguments.py:1198] :   hidden_dropout .................................. 0.0
[20251218 08:14:38][root/amd][pre_trainer][ip-10.21.9.25][rank-0/8][DEBUG] [------arguments.py:1198] :   hidden_size ..................................... 4096
[20251218 08:14:38][root/amd][pre_trainer][ip-10.21.9.25][rank-0/8][DEBUG] [------arguments.py:1198] :   hierarchical_context_parallel_sizes ............. None
[20251218 08:14:38][root/amd][pre_trainer][ip-10.21.9.25][rank-0/8][DEBUG] [------arguments.py:1198] :   high_priority_stream_groups ..................... []
[20251218 08:14:38][root/amd][pre_trainer][ip-10.21.9.25][rank-0/8][DEBUG] [------arguments.py:1198] :   hybrid_attention_ratio .......................... 0.0
[20251218 08:14:38][root/amd][pre_trainer][ip-10.21.9.25][rank-0/8][DEBUG] [------arguments.py:1198] :   hybrid_mlp_ratio ................................ 0.0
[20251218 08:14:38][root/amd][pre_trainer][ip-10.21.9.25][rank-0/8][DEBUG] [------arguments.py:1198] :   hybrid_override_pattern ......................... None
[20251218 08:14:38][root/amd][pre_trainer][ip-10.21.9.25][rank-0/8][DEBUG] [------arguments.py:1198] :   hysteresis ...................................... 2
[20251218 08:14:38][root/amd][pre_trainer][ip-10.21.9.25][rank-0/8][DEBUG] [------arguments.py:1198] :   ict_head_size ................................... None
[20251218 08:14:38][root/amd][pre_trainer][ip-10.21.9.25][rank-0/8][DEBUG] [------arguments.py:1198] :   ict_load ........................................ None
[20251218 08:14:38][root/amd][pre_trainer][ip-10.21.9.25][rank-0/8][DEBUG] [------arguments.py:1198] :   img_h ........................................... 224
[20251218 08:14:38][root/amd][pre_trainer][ip-10.21.9.25][rank-0/8][DEBUG] [------arguments.py:1198] :   img_w ........................................... 224
[20251218 08:14:38][root/amd][pre_trainer][ip-10.21.9.25][rank-0/8][DEBUG] [------arguments.py:1198] :   indexer_batch_size .............................. 128
[20251218 08:14:38][root/amd][pre_trainer][ip-10.21.9.25][rank-0/8][DEBUG] [------arguments.py:1198] :   indexer_log_interval ............................ 1000
[20251218 08:14:38][root/amd][pre_trainer][ip-10.21.9.25][rank-0/8][DEBUG] [------arguments.py:1198] :   inference_batch_times_seqlen_threshold .......... -1
[20251218 08:14:38][root/amd][pre_trainer][ip-10.21.9.25][rank-0/8][DEBUG] [------arguments.py:1198] :   inference_dynamic_batching ...................... False
[20251218 08:14:38][root/amd][pre_trainer][ip-10.21.9.25][rank-0/8][DEBUG] [------arguments.py:1198] :   inference_dynamic_batching_buffer_guaranteed_fraction  0.2
[20251218 08:14:38][root/amd][pre_trainer][ip-10.21.9.25][rank-0/8][DEBUG] [------arguments.py:1198] :   inference_dynamic_batching_buffer_overflow_factor  None
[20251218 08:14:38][root/amd][pre_trainer][ip-10.21.9.25][rank-0/8][DEBUG] [------arguments.py:1198] :   inference_dynamic_batching_buffer_size_gb ....... 40.0
[20251218 08:14:38][root/amd][pre_trainer][ip-10.21.9.25][rank-0/8][DEBUG] [------arguments.py:1198] :   inference_dynamic_batching_max_requests_override  None
[20251218 08:14:38][root/amd][pre_trainer][ip-10.21.9.25][rank-0/8][DEBUG] [------arguments.py:1198] :   inference_dynamic_batching_max_tokens_override .. None
[20251218 08:14:38][root/amd][pre_trainer][ip-10.21.9.25][rank-0/8][DEBUG] [------arguments.py:1198] :   inference_max_requests .......................... 8
[20251218 08:14:38][root/amd][pre_trainer][ip-10.21.9.25][rank-0/8][DEBUG] [------arguments.py:1198] :   inference_max_seq_length ........................ 2560
[20251218 08:14:38][root/amd][pre_trainer][ip-10.21.9.25][rank-0/8][DEBUG] [------arguments.py:1198] :   inference_rng_tracker ........................... False
[20251218 08:14:38][root/amd][pre_trainer][ip-10.21.9.25][rank-0/8][DEBUG] [------arguments.py:1198] :   init_method_std ................................. 0.008
[20251218 08:14:38][root/amd][pre_trainer][ip-10.21.9.25][rank-0/8][DEBUG] [------arguments.py:1198] :   init_method_xavier_uniform ...................... False
[20251218 08:14:38][root/amd][pre_trainer][ip-10.21.9.25][rank-0/8][DEBUG] [------arguments.py:1198] :   init_model_with_meta_device ..................... False
[20251218 08:14:38][root/amd][pre_trainer][ip-10.21.9.25][rank-0/8][DEBUG] [------arguments.py:1198] :   initial_loss_scale .............................. 4294967296
[20251218 08:14:38][root/amd][pre_trainer][ip-10.21.9.25][rank-0/8][DEBUG] [------arguments.py:1198] :   inprocess_restart ............................... False
[20251218 08:14:38][root/amd][pre_trainer][ip-10.21.9.25][rank-0/8][DEBUG] [------arguments.py:1198] :   interleave_group_size ........................... 0
[20251218 08:14:38][root/amd][pre_trainer][ip-10.21.9.25][rank-0/8][DEBUG] [------arguments.py:1198] :   is_hybrid_model ................................. False
[20251218 08:14:38][root/amd][pre_trainer][ip-10.21.9.25][rank-0/8][DEBUG] [------arguments.py:1198] :   iter_per_epoch .................................. 1250
[20251218 08:14:38][root/amd][pre_trainer][ip-10.21.9.25][rank-0/8][DEBUG] [------arguments.py:1198] :   iterations_to_skip .............................. []
[20251218 08:14:38][root/amd][pre_trainer][ip-10.21.9.25][rank-0/8][DEBUG] [------arguments.py:1198] :   keep_fp8_transpose_cache_when_using_custom_fsdp . False
[20251218 08:14:38][root/amd][pre_trainer][ip-10.21.9.25][rank-0/8][DEBUG] [------arguments.py:1198] :   kv_channels ..................................... 128
[20251218 08:14:38][root/amd][pre_trainer][ip-10.21.9.25][rank-0/8][DEBUG] [------arguments.py:1198] :   kv_lora_rank .................................... 32
[20251218 08:14:38][root/amd][pre_trainer][ip-10.21.9.25][rank-0/8][DEBUG] [------arguments.py:1198] :   langrl_env_config ............................... None
[20251218 08:14:38][root/amd][pre_trainer][ip-10.21.9.25][rank-0/8][DEBUG] [------arguments.py:1198] :   langrl_inference_server_conversation_template ... None
[20251218 08:14:38][root/amd][pre_trainer][ip-10.21.9.25][rank-0/8][DEBUG] [------arguments.py:1198] :   langrl_inference_server_type .................... inplace_megatron
[20251218 08:14:38][root/amd][pre_trainer][ip-10.21.9.25][rank-0/8][DEBUG] [------arguments.py:1198] :   lazy_mpu_init ................................... None
[20251218 08:14:38][root/amd][pre_trainer][ip-10.21.9.25][rank-0/8][DEBUG] [------arguments.py:1198] :   legacy_tokenizer ................................ False
[20251218 08:14:38][root/amd][pre_trainer][ip-10.21.9.25][rank-0/8][DEBUG] [------arguments.py:1198] :   load ............................................ None
[20251218 08:14:38][root/amd][pre_trainer][ip-10.21.9.25][rank-0/8][DEBUG] [------arguments.py:1198] :   load_main_params_from_ckpt ...................... False
[20251218 08:14:38][root/amd][pre_trainer][ip-10.21.9.25][rank-0/8][DEBUG] [------arguments.py:1198] :   local_rank ...................................... 0
[20251218 08:14:38][root/amd][pre_trainer][ip-10.21.9.25][rank-0/8][DEBUG] [------arguments.py:1198] :   log_avg_reset_interval .......................... 50
[20251218 08:14:38][root/amd][pre_trainer][ip-10.21.9.25][rank-0/8][DEBUG] [------arguments.py:1198] :   log_avg_skip_iterations ......................... 2
[20251218 08:14:38][root/amd][pre_trainer][ip-10.21.9.25][rank-0/8][DEBUG] [------arguments.py:1198] :   log_batch_size_to_tensorboard ................... True
[20251218 08:14:38][root/amd][pre_trainer][ip-10.21.9.25][rank-0/8][DEBUG] [------arguments.py:1198] :   log_interval .................................... 1
[20251218 08:14:38][root/amd][pre_trainer][ip-10.21.9.25][rank-0/8][DEBUG] [------arguments.py:1198] :   log_learning_rate_to_tensorboard ................ True
[20251218 08:14:38][root/amd][pre_trainer][ip-10.21.9.25][rank-0/8][DEBUG] [------arguments.py:1198] :   log_loss_scale_to_tensorboard ................... True
[20251218 08:14:38][root/amd][pre_trainer][ip-10.21.9.25][rank-0/8][DEBUG] [------arguments.py:1198] :   log_memory_to_tensorboard ....................... False
[20251218 08:14:38][root/amd][pre_trainer][ip-10.21.9.25][rank-0/8][DEBUG] [------arguments.py:1198] :   log_num_zeros_in_grad ........................... False
[20251218 08:14:38][root/amd][pre_trainer][ip-10.21.9.25][rank-0/8][DEBUG] [------arguments.py:1198] :   log_params_norm ................................. False
[20251218 08:14:38][root/amd][pre_trainer][ip-10.21.9.25][rank-0/8][DEBUG] [------arguments.py:1198] :   log_progress .................................... False
[20251218 08:14:38][root/amd][pre_trainer][ip-10.21.9.25][rank-0/8][DEBUG] [------arguments.py:1198] :   log_straggler ................................... False
[20251218 08:14:38][root/amd][pre_trainer][ip-10.21.9.25][rank-0/8][DEBUG] [------arguments.py:1198] :   log_throughput .................................. True
[20251218 08:14:38][root/amd][pre_trainer][ip-10.21.9.25][rank-0/8][DEBUG] [------arguments.py:1198] :   log_timers_to_tensorboard ....................... True
[20251218 08:14:38][root/amd][pre_trainer][ip-10.21.9.25][rank-0/8][DEBUG] [------arguments.py:1198] :   log_validation_ppl_to_tensorboard ............... False
[20251218 08:14:38][root/amd][pre_trainer][ip-10.21.9.25][rank-0/8][DEBUG] [------arguments.py:1198] :   log_world_size_to_tensorboard ................... False
[20251218 08:14:38][root/amd][pre_trainer][ip-10.21.9.25][rank-0/8][DEBUG] [------arguments.py:1198] :   logging_level ................................... 10
[20251218 08:14:38][root/amd][pre_trainer][ip-10.21.9.25][rank-0/8][DEBUG] [------arguments.py:1198] :   loss_scale ...................................... None
[20251218 08:14:38][root/amd][pre_trainer][ip-10.21.9.25][rank-0/8][DEBUG] [------arguments.py:1198] :   loss_scale_window ............................... 1000
[20251218 08:14:38][root/amd][pre_trainer][ip-10.21.9.25][rank-0/8][DEBUG] [------arguments.py:1198] :   lr .............................................. 1e-05
[20251218 08:14:38][root/amd][pre_trainer][ip-10.21.9.25][rank-0/8][DEBUG] [------arguments.py:1198] :   lr_decay_iters .................................. None
[20251218 08:14:38][root/amd][pre_trainer][ip-10.21.9.25][rank-0/8][DEBUG] [------arguments.py:1198] :   lr_decay_samples ................................ None
[20251218 08:14:38][root/amd][pre_trainer][ip-10.21.9.25][rank-0/8][DEBUG] [------arguments.py:1198] :   lr_decay_style .................................. cosine
[20251218 08:14:38][root/amd][pre_trainer][ip-10.21.9.25][rank-0/8][DEBUG] [------arguments.py:1198] :   lr_warmup_fraction .............................. None
[20251218 08:14:38][root/amd][pre_trainer][ip-10.21.9.25][rank-0/8][DEBUG] [------arguments.py:1198] :   lr_warmup_init .................................. 0.0
[20251218 08:14:38][root/amd][pre_trainer][ip-10.21.9.25][rank-0/8][DEBUG] [------arguments.py:1198] :   lr_warmup_iters ................................. 2
[20251218 08:14:38][root/amd][pre_trainer][ip-10.21.9.25][rank-0/8][DEBUG] [------arguments.py:1198] :   lr_warmup_samples ............................... 0
[20251218 08:14:38][root/amd][pre_trainer][ip-10.21.9.25][rank-0/8][DEBUG] [------arguments.py:1198] :   lr_wsd_decay_iters .............................. None
[20251218 08:14:38][root/amd][pre_trainer][ip-10.21.9.25][rank-0/8][DEBUG] [------arguments.py:1198] :   lr_wsd_decay_samples ............................ None
[20251218 08:14:38][root/amd][pre_trainer][ip-10.21.9.25][rank-0/8][DEBUG] [------arguments.py:1198] :   lr_wsd_decay_style .............................. exponential
[20251218 08:14:38][root/amd][pre_trainer][ip-10.21.9.25][rank-0/8][DEBUG] [------arguments.py:1198] :   main_grads_dtype ................................ torch.float32
[20251218 08:14:38][root/amd][pre_trainer][ip-10.21.9.25][rank-0/8][DEBUG] [------arguments.py:1198] :   main_params_dtype ............................... torch.float32
[20251218 08:14:38][root/amd][pre_trainer][ip-10.21.9.25][rank-0/8][DEBUG] [------arguments.py:1198] :   make_vocab_size_divisible_by .................... 128
[20251218 08:14:38][root/amd][pre_trainer][ip-10.21.9.25][rank-0/8][DEBUG] [------arguments.py:1198] :   mamba_head_dim .................................. 64
[20251218 08:14:38][root/amd][pre_trainer][ip-10.21.9.25][rank-0/8][DEBUG] [------arguments.py:1198] :   mamba_num_groups ................................ 8
[20251218 08:14:38][root/amd][pre_trainer][ip-10.21.9.25][rank-0/8][DEBUG] [------arguments.py:1198] :   mamba_num_heads ................................. None
[20251218 08:14:38][root/amd][pre_trainer][ip-10.21.9.25][rank-0/8][DEBUG] [------arguments.py:1198] :   mamba_state_dim ................................. 128
[20251218 08:14:38][root/amd][pre_trainer][ip-10.21.9.25][rank-0/8][DEBUG] [------arguments.py:1198] :   manual_gc ....................................... False
[20251218 08:14:38][root/amd][pre_trainer][ip-10.21.9.25][rank-0/8][DEBUG] [------arguments.py:1198] :   manual_gc_eval .................................. False
[20251218 08:14:38][root/amd][pre_trainer][ip-10.21.9.25][rank-0/8][DEBUG] [------arguments.py:1198] :   manual_gc_interval .............................. 1
[20251218 08:14:38][root/amd][pre_trainer][ip-10.21.9.25][rank-0/8][DEBUG] [------arguments.py:1198] :   mask_factor ..................................... 1.0
[20251218 08:14:38][root/amd][pre_trainer][ip-10.21.9.25][rank-0/8][DEBUG] [------arguments.py:1198] :   mask_prob ....................................... 0.15
[20251218 08:14:38][root/amd][pre_trainer][ip-10.21.9.25][rank-0/8][DEBUG] [------arguments.py:1198] :   mask_type ....................................... random
[20251218 08:14:38][root/amd][pre_trainer][ip-10.21.9.25][rank-0/8][DEBUG] [------arguments.py:1198] :   masked_softmax_fusion ........................... False
[20251218 08:14:38][root/amd][pre_trainer][ip-10.21.9.25][rank-0/8][DEBUG] [------arguments.py:1198] :   max_position_embeddings ......................... 8192
[20251218 08:14:38][root/amd][pre_trainer][ip-10.21.9.25][rank-0/8][DEBUG] [------arguments.py:1198] :   max_tokens_to_oom ............................... 12000
[20251218 08:14:38][root/amd][pre_trainer][ip-10.21.9.25][rank-0/8][DEBUG] [------arguments.py:1198] :   memory_snapshot_path ............................ snapshot.pickle
[20251218 08:14:38][root/amd][pre_trainer][ip-10.21.9.25][rank-0/8][DEBUG] [------arguments.py:1198] :   merge_file ...................................... None
[20251218 08:14:38][root/amd][pre_trainer][ip-10.21.9.25][rank-0/8][DEBUG] [------arguments.py:1198] :   micro_batch_size ................................ 2
[20251218 08:14:38][root/amd][pre_trainer][ip-10.21.9.25][rank-0/8][DEBUG] [------arguments.py:1198] :   microbatch_group_size_per_vp_stage .............. None
[20251218 08:14:38][root/amd][pre_trainer][ip-10.21.9.25][rank-0/8][DEBUG] [------arguments.py:1198] :   min_loss_scale .................................. 1.0
[20251218 08:14:38][root/amd][pre_trainer][ip-10.21.9.25][rank-0/8][DEBUG] [------arguments.py:1198] :   min_lr .......................................... 0.0
[20251218 08:14:38][root/amd][pre_trainer][ip-10.21.9.25][rank-0/8][DEBUG] [------arguments.py:1198] :   mlflow_experiment_name .......................... None
[20251218 08:14:38][root/amd][pre_trainer][ip-10.21.9.25][rank-0/8][DEBUG] [------arguments.py:1198] :   mlflow_run_name ................................. None
[20251218 08:14:38][root/amd][pre_trainer][ip-10.21.9.25][rank-0/8][DEBUG] [------arguments.py:1198] :   mmap_bin_files .................................. True
[20251218 08:14:38][root/amd][pre_trainer][ip-10.21.9.25][rank-0/8][DEBUG] [------arguments.py:1198] :   mock_data ....................................... True
[20251218 08:14:38][root/amd][pre_trainer][ip-10.21.9.25][rank-0/8][DEBUG] [------arguments.py:1198] :   moe_aux_loss_coeff .............................. 0.0
[20251218 08:14:38][root/amd][pre_trainer][ip-10.21.9.25][rank-0/8][DEBUG] [------arguments.py:1198] :   moe_enable_deepep ............................... False
[20251218 08:14:38][root/amd][pre_trainer][ip-10.21.9.25][rank-0/8][DEBUG] [------arguments.py:1198] :   moe_expert_capacity_factor ...................... None
[20251218 08:14:38][root/amd][pre_trainer][ip-10.21.9.25][rank-0/8][DEBUG] [------arguments.py:1198] :   moe_extended_tp ................................. False
[20251218 08:14:38][root/amd][pre_trainer][ip-10.21.9.25][rank-0/8][DEBUG] [------arguments.py:1198] :   moe_ffn_hidden_size ............................. None
[20251218 08:14:38][root/amd][pre_trainer][ip-10.21.9.25][rank-0/8][DEBUG] [------arguments.py:1198] :   moe_grouped_gemm ................................ False
[20251218 08:14:38][root/amd][pre_trainer][ip-10.21.9.25][rank-0/8][DEBUG] [------arguments.py:1198] :   moe_input_jitter_eps ............................ None
[20251218 08:14:38][root/amd][pre_trainer][ip-10.21.9.25][rank-0/8][DEBUG] [------arguments.py:1198] :   moe_layer_freq .................................. 1
[20251218 08:14:38][root/amd][pre_trainer][ip-10.21.9.25][rank-0/8][DEBUG] [------arguments.py:1198] :   moe_layer_recompute ............................. False
[20251218 08:14:38][root/amd][pre_trainer][ip-10.21.9.25][rank-0/8][DEBUG] [------arguments.py:1198] :   moe_pad_expert_input_to_capacity ................ False
[20251218 08:14:38][root/amd][pre_trainer][ip-10.21.9.25][rank-0/8][DEBUG] [------arguments.py:1198] :   moe_per_layer_logging ........................... False
[20251218 08:14:38][root/amd][pre_trainer][ip-10.21.9.25][rank-0/8][DEBUG] [------arguments.py:1198] :   moe_permute_fusion .............................. False
[20251218 08:14:38][root/amd][pre_trainer][ip-10.21.9.25][rank-0/8][DEBUG] [------arguments.py:1198] :   moe_router_bias_update_rate ..................... 0.001
[20251218 08:14:38][root/amd][pre_trainer][ip-10.21.9.25][rank-0/8][DEBUG] [------arguments.py:1198] :   moe_router_dtype ................................ None
[20251218 08:14:38][root/amd][pre_trainer][ip-10.21.9.25][rank-0/8][DEBUG] [------arguments.py:1198] :   moe_router_enable_expert_bias ................... False
[20251218 08:14:38][root/amd][pre_trainer][ip-10.21.9.25][rank-0/8][DEBUG] [------arguments.py:1198] :   moe_router_force_load_balancing ................. False
[20251218 08:14:38][root/amd][pre_trainer][ip-10.21.9.25][rank-0/8][DEBUG] [------arguments.py:1198] :   moe_router_group_topk ........................... None
[20251218 08:14:38][root/amd][pre_trainer][ip-10.21.9.25][rank-0/8][DEBUG] [------arguments.py:1198] :   moe_router_load_balancing_type .................. aux_loss
[20251218 08:14:38][root/amd][pre_trainer][ip-10.21.9.25][rank-0/8][DEBUG] [------arguments.py:1198] :   moe_router_num_groups ........................... None
[20251218 08:14:38][root/amd][pre_trainer][ip-10.21.9.25][rank-0/8][DEBUG] [------arguments.py:1198] :   moe_router_pre_softmax .......................... False
[20251218 08:14:38][root/amd][pre_trainer][ip-10.21.9.25][rank-0/8][DEBUG] [------arguments.py:1198] :   moe_router_score_function ....................... softmax
[20251218 08:14:38][root/amd][pre_trainer][ip-10.21.9.25][rank-0/8][DEBUG] [------arguments.py:1198] :   moe_router_topk ................................. 2
[20251218 08:14:38][root/amd][pre_trainer][ip-10.21.9.25][rank-0/8][DEBUG] [------arguments.py:1198] :   moe_router_topk_scaling_factor .................. None
[20251218 08:14:38][root/amd][pre_trainer][ip-10.21.9.25][rank-0/8][DEBUG] [------arguments.py:1198] :   moe_shared_expert_intermediate_size ............. None
[20251218 08:14:38][root/amd][pre_trainer][ip-10.21.9.25][rank-0/8][DEBUG] [------arguments.py:1198] :   moe_shared_expert_overlap ....................... False
[20251218 08:14:38][root/amd][pre_trainer][ip-10.21.9.25][rank-0/8][DEBUG] [------arguments.py:1198] :   moe_token_dispatcher_type ....................... allgather
[20251218 08:14:38][root/amd][pre_trainer][ip-10.21.9.25][rank-0/8][DEBUG] [------arguments.py:1198] :   moe_token_drop_policy ........................... probs
[20251218 08:14:38][root/amd][pre_trainer][ip-10.21.9.25][rank-0/8][DEBUG] [------arguments.py:1198] :   moe_use_fused_router_with_aux_score ............. False
[20251218 08:14:38][root/amd][pre_trainer][ip-10.21.9.25][rank-0/8][DEBUG] [------arguments.py:1198] :   moe_use_legacy_grouped_gemm ..................... False
[20251218 08:14:38][root/amd][pre_trainer][ip-10.21.9.25][rank-0/8][DEBUG] [------arguments.py:1198] :   moe_use_upcycling ............................... False
[20251218 08:14:38][root/amd][pre_trainer][ip-10.21.9.25][rank-0/8][DEBUG] [------arguments.py:1198] :   moe_z_loss_coeff ................................ None
[20251218 08:14:38][root/amd][pre_trainer][ip-10.21.9.25][rank-0/8][DEBUG] [------arguments.py:1198] :   mscale .......................................... 1.0
[20251218 08:14:38][root/amd][pre_trainer][ip-10.21.9.25][rank-0/8][DEBUG] [------arguments.py:1198] :   mscale_all_dim .................................. 1.0
[20251218 08:14:38][root/amd][pre_trainer][ip-10.21.9.25][rank-0/8][DEBUG] [------arguments.py:1198] :   mtp_loss_scaling_factor ......................... 0.1
[20251218 08:14:38][root/amd][pre_trainer][ip-10.21.9.25][rank-0/8][DEBUG] [------arguments.py:1198] :   mtp_num_layers .................................. None
[20251218 08:14:38][root/amd][pre_trainer][ip-10.21.9.25][rank-0/8][DEBUG] [------arguments.py:1198] :   multi_latent_attention .......................... False
[20251218 08:14:38][root/amd][pre_trainer][ip-10.21.9.25][rank-0/8][DEBUG] [------arguments.py:1198] :   multiple_validation_sets ........................ False
[20251218 08:14:38][root/amd][pre_trainer][ip-10.21.9.25][rank-0/8][DEBUG] [------arguments.py:1198] :   name ............................................ pre_trainer
[20251218 08:14:38][root/amd][pre_trainer][ip-10.21.9.25][rank-0/8][DEBUG] [------arguments.py:1198] :   nccl_communicator_config_path ................... None
[20251218 08:14:38][root/amd][pre_trainer][ip-10.21.9.25][rank-0/8][DEBUG] [------arguments.py:1198] :   no_fp8_weight_transpose_cache ................... False
[20251218 08:14:38][root/amd][pre_trainer][ip-10.21.9.25][rank-0/8][DEBUG] [------arguments.py:1198] :   no_load_optim ................................... None
[20251218 08:14:38][root/amd][pre_trainer][ip-10.21.9.25][rank-0/8][DEBUG] [------arguments.py:1198] :   no_load_rng ..................................... None
[20251218 08:14:38][root/amd][pre_trainer][ip-10.21.9.25][rank-0/8][DEBUG] [------arguments.py:1198] :   no_persist_layer_norm ........................... False
[20251218 08:14:38][root/amd][pre_trainer][ip-10.21.9.25][rank-0/8][DEBUG] [------arguments.py:1198] :   no_save_optim ................................... None
[20251218 08:14:38][root/amd][pre_trainer][ip-10.21.9.25][rank-0/8][DEBUG] [------arguments.py:1198] :   no_save_rng ..................................... None
[20251218 08:14:38][root/amd][pre_trainer][ip-10.21.9.25][rank-0/8][DEBUG] [------arguments.py:1198] :   non_persistent_ckpt_type ........................ None
[20251218 08:14:38][root/amd][pre_trainer][ip-10.21.9.25][rank-0/8][DEBUG] [------arguments.py:1198] :   non_persistent_global_ckpt_dir .................. None
[20251218 08:14:38][root/amd][pre_trainer][ip-10.21.9.25][rank-0/8][DEBUG] [------arguments.py:1198] :   non_persistent_local_ckpt_algo .................. fully_parallel
[20251218 08:14:38][root/amd][pre_trainer][ip-10.21.9.25][rank-0/8][DEBUG] [------arguments.py:1198] :   non_persistent_local_ckpt_dir ................... None
[20251218 08:14:38][root/amd][pre_trainer][ip-10.21.9.25][rank-0/8][DEBUG] [------arguments.py:1198] :   non_persistent_save_interval .................... None
[20251218 08:14:38][root/amd][pre_trainer][ip-10.21.9.25][rank-0/8][DEBUG] [------arguments.py:1198] :   norm_epsilon .................................... 1e-06
[20251218 08:14:38][root/amd][pre_trainer][ip-10.21.9.25][rank-0/8][DEBUG] [------arguments.py:1198] :   normalization ................................... RMSNorm
[20251218 08:14:38][root/amd][pre_trainer][ip-10.21.9.25][rank-0/8][DEBUG] [------arguments.py:1198] :   num_attention_heads ............................. 32
[20251218 08:14:38][root/amd][pre_trainer][ip-10.21.9.25][rank-0/8][DEBUG] [------arguments.py:1198] :   num_channels .................................... 3
[20251218 08:14:38][root/amd][pre_trainer][ip-10.21.9.25][rank-0/8][DEBUG] [------arguments.py:1198] :   num_classes ..................................... 1000
[20251218 08:14:38][root/amd][pre_trainer][ip-10.21.9.25][rank-0/8][DEBUG] [------arguments.py:1198] :   num_dataset_builder_threads ..................... 1
[20251218 08:14:38][root/amd][pre_trainer][ip-10.21.9.25][rank-0/8][DEBUG] [------arguments.py:1198] :   num_distributed_optimizer_instances ............. 1
[20251218 08:14:38][root/amd][pre_trainer][ip-10.21.9.25][rank-0/8][DEBUG] [------arguments.py:1198] :   num_experts ..................................... None
[20251218 08:14:38][root/amd][pre_trainer][ip-10.21.9.25][rank-0/8][DEBUG] [------arguments.py:1198] :   num_layers ...................................... 32
[20251218 08:14:38][root/amd][pre_trainer][ip-10.21.9.25][rank-0/8][DEBUG] [------arguments.py:1198] :   num_layers_at_end_in_bf16 ....................... 1
[20251218 08:14:38][root/amd][pre_trainer][ip-10.21.9.25][rank-0/8][DEBUG] [------arguments.py:1198] :   num_layers_at_start_in_bf16 ..................... 1
[20251218 08:14:38][root/amd][pre_trainer][ip-10.21.9.25][rank-0/8][DEBUG] [------arguments.py:1198] :   num_layers_per_virtual_pipeline_stage ........... None
[20251218 08:14:38][root/amd][pre_trainer][ip-10.21.9.25][rank-0/8][DEBUG] [------arguments.py:1198] :   num_query_groups ................................ 8
[20251218 08:14:38][root/amd][pre_trainer][ip-10.21.9.25][rank-0/8][DEBUG] [------arguments.py:1198] :   num_seq_splits .................................. 1
[20251218 08:14:38][root/amd][pre_trainer][ip-10.21.9.25][rank-0/8][DEBUG] [------arguments.py:1198] :   num_virtual_stages_per_pipeline_rank ............ None
[20251218 08:14:38][root/amd][pre_trainer][ip-10.21.9.25][rank-0/8][DEBUG] [------arguments.py:1198] :   num_workers ..................................... 8
[20251218 08:14:38][root/amd][pre_trainer][ip-10.21.9.25][rank-0/8][DEBUG] [------arguments.py:1198] :   offload_chunk_num ............................... 0
[20251218 08:14:38][root/amd][pre_trainer][ip-10.21.9.25][rank-0/8][DEBUG] [------arguments.py:1198] :   offload_overlap_sr .............................. True
[20251218 08:14:38][root/amd][pre_trainer][ip-10.21.9.25][rank-0/8][DEBUG] [------arguments.py:1198] :   offload_time .................................... 1.0
[20251218 08:14:38][root/amd][pre_trainer][ip-10.21.9.25][rank-0/8][DEBUG] [------arguments.py:1198] :   one_logger_async ................................ False
[20251218 08:14:38][root/amd][pre_trainer][ip-10.21.9.25][rank-0/8][DEBUG] [------arguments.py:1198] :   one_logger_project .............................. megatron-lm
[20251218 08:14:38][root/amd][pre_trainer][ip-10.21.9.25][rank-0/8][DEBUG] [------arguments.py:1198] :   one_logger_run_name ............................. None
[20251218 08:14:38][root/amd][pre_trainer][ip-10.21.9.25][rank-0/8][DEBUG] [------arguments.py:1198] :   onnx_safe ....................................... None
[20251218 08:14:38][root/amd][pre_trainer][ip-10.21.9.25][rank-0/8][DEBUG] [------arguments.py:1198] :   openai_gelu ..................................... False
[20251218 08:14:38][root/amd][pre_trainer][ip-10.21.9.25][rank-0/8][DEBUG] [------arguments.py:1198] :   optimizer ....................................... adam
[20251218 08:14:38][root/amd][pre_trainer][ip-10.21.9.25][rank-0/8][DEBUG] [------arguments.py:1198] :   optimizer_cpu_offload ........................... False
[20251218 08:14:38][root/amd][pre_trainer][ip-10.21.9.25][rank-0/8][DEBUG] [------arguments.py:1198] :   optimizer_offload_fraction ...................... 1.0
[20251218 08:14:38][root/amd][pre_trainer][ip-10.21.9.25][rank-0/8][DEBUG] [------arguments.py:1198] :   output_bert_embeddings .......................... False
[20251218 08:14:38][root/amd][pre_trainer][ip-10.21.9.25][rank-0/8][DEBUG] [------arguments.py:1198] :   overlap_cpu_optimizer_d2h_h2d ................... False
[20251218 08:14:38][root/amd][pre_trainer][ip-10.21.9.25][rank-0/8][DEBUG] [------arguments.py:1198] :   overlap_grad_reduce ............................. True
[20251218 08:14:38][root/amd][pre_trainer][ip-10.21.9.25][rank-0/8][DEBUG] [------arguments.py:1198] :   overlap_moe_expert_parallel_comm ................ False
[20251218 08:14:38][root/amd][pre_trainer][ip-10.21.9.25][rank-0/8][DEBUG] [------arguments.py:1198] :   overlap_p2p_comm ................................ False
[20251218 08:14:38][root/amd][pre_trainer][ip-10.21.9.25][rank-0/8][DEBUG] [------arguments.py:1198] :   overlap_param_gather ............................ True
[20251218 08:14:38][root/amd][pre_trainer][ip-10.21.9.25][rank-0/8][DEBUG] [------arguments.py:1198] :   overlap_param_gather_with_optimizer_step ........ False
[20251218 08:14:38][root/amd][pre_trainer][ip-10.21.9.25][rank-0/8][DEBUG] [------arguments.py:1198] :   override_opt_param_scheduler .................... True
[20251218 08:14:38][root/amd][pre_trainer][ip-10.21.9.25][rank-0/8][DEBUG] [------arguments.py:1198] :   parallel_output ................................. False
[20251218 08:14:38][root/amd][pre_trainer][ip-10.21.9.25][rank-0/8][DEBUG] [------arguments.py:1198] :   params_dtype .................................... torch.bfloat16
[20251218 08:14:38][root/amd][pre_trainer][ip-10.21.9.25][rank-0/8][DEBUG] [------arguments.py:1198] :   patch_dim ....................................... 16
[20251218 08:14:38][root/amd][pre_trainer][ip-10.21.9.25][rank-0/8][DEBUG] [------arguments.py:1198] :   patch_moe_overlap ............................... False
[20251218 08:14:38][root/amd][pre_trainer][ip-10.21.9.25][rank-0/8][DEBUG] [------arguments.py:1198] :   patch_zero_bubble ............................... False
[20251218 08:14:38][root/amd][pre_trainer][ip-10.21.9.25][rank-0/8][DEBUG] [------arguments.py:1198] :   per_split_data_args_path ........................ None
[20251218 08:14:38][root/amd][pre_trainer][ip-10.21.9.25][rank-0/8][DEBUG] [------arguments.py:1198] :   perform_initialization .......................... True
[20251218 08:14:38][root/amd][pre_trainer][ip-10.21.9.25][rank-0/8][DEBUG] [------arguments.py:1198] :   perform_rl_step ................................. False
[20251218 08:14:38][root/amd][pre_trainer][ip-10.21.9.25][rank-0/8][DEBUG] [------arguments.py:1198] :   pin_cpu_grads ................................... True
[20251218 08:14:38][root/amd][pre_trainer][ip-10.21.9.25][rank-0/8][DEBUG] [------arguments.py:1198] :   pin_cpu_params .................................. True
[20251218 08:14:38][root/amd][pre_trainer][ip-10.21.9.25][rank-0/8][DEBUG] [------arguments.py:1198] :   pipeline_model_parallel_comm_backend ............ None
[20251218 08:14:38][root/amd][pre_trainer][ip-10.21.9.25][rank-0/8][DEBUG] [------arguments.py:1198] :   pipeline_model_parallel_layout .................. None
[20251218 08:14:38][root/amd][pre_trainer][ip-10.21.9.25][rank-0/8][DEBUG] [------arguments.py:1198] :   pipeline_model_parallel_size .................... 1
[20251218 08:14:38][root/amd][pre_trainer][ip-10.21.9.25][rank-0/8][DEBUG] [------arguments.py:1198] :   pipeline_model_parallel_split_rank .............. None
[20251218 08:14:38][root/amd][pre_trainer][ip-10.21.9.25][rank-0/8][DEBUG] [------arguments.py:1198] :   position_embedding_type ......................... rope
[20251218 08:14:38][root/amd][pre_trainer][ip-10.21.9.25][rank-0/8][DEBUG] [------arguments.py:1198] :   pp_warmup ....................................... False
[20251218 08:14:38][root/amd][pre_trainer][ip-10.21.9.25][rank-0/8][DEBUG] [------arguments.py:1198] :   pre_communication_optimization .................. False
[20251218 08:14:38][root/amd][pre_trainer][ip-10.21.9.25][rank-0/8][DEBUG] [------arguments.py:1198] :   pretrained_checkpoint ........................... None
[20251218 08:14:38][root/amd][pre_trainer][ip-10.21.9.25][rank-0/8][DEBUG] [------arguments.py:1198] :   profile ......................................... False
[20251218 08:14:38][root/amd][pre_trainer][ip-10.21.9.25][rank-0/8][DEBUG] [------arguments.py:1198] :   profile_memory_iter ............................. -1
[20251218 08:14:38][root/amd][pre_trainer][ip-10.21.9.25][rank-0/8][DEBUG] [------arguments.py:1198] :   profile_ranks ................................... [0]
[20251218 08:14:38][root/amd][pre_trainer][ip-10.21.9.25][rank-0/8][DEBUG] [------arguments.py:1198] :   profile_step_end ................................ 12
[20251218 08:14:38][root/amd][pre_trainer][ip-10.21.9.25][rank-0/8][DEBUG] [------arguments.py:1198] :   profile_step_start .............................. 10
[20251218 08:14:38][root/amd][pre_trainer][ip-10.21.9.25][rank-0/8][DEBUG] [------arguments.py:1198] :   q_lora_rank ..................................... None
[20251218 08:14:38][root/amd][pre_trainer][ip-10.21.9.25][rank-0/8][DEBUG] [------arguments.py:1198] :   qk_head_dim ..................................... 128
[20251218 08:14:38][root/amd][pre_trainer][ip-10.21.9.25][rank-0/8][DEBUG] [------arguments.py:1198] :   qk_l2_norm ...................................... False
[20251218 08:14:38][root/amd][pre_trainer][ip-10.21.9.25][rank-0/8][DEBUG] [------arguments.py:1198] :   qk_layernorm .................................... False
[20251218 08:14:38][root/amd][pre_trainer][ip-10.21.9.25][rank-0/8][DEBUG] [------arguments.py:1198] :   qk_pos_emb_head_dim ............................. 64
[20251218 08:14:38][root/amd][pre_trainer][ip-10.21.9.25][rank-0/8][DEBUG] [------arguments.py:1198] :   query_in_block_prob ............................. 0.1
[20251218 08:14:38][root/amd][pre_trainer][ip-10.21.9.25][rank-0/8][DEBUG] [------arguments.py:1198] :   quick_geglu ..................................... False
[20251218 08:14:38][root/amd][pre_trainer][ip-10.21.9.25][rank-0/8][DEBUG] [------arguments.py:1198] :   rampup_batch_size ............................... None
[20251218 08:14:38][root/amd][pre_trainer][ip-10.21.9.25][rank-0/8][DEBUG] [------arguments.py:1198] :   rank ............................................ 0
[20251218 08:14:38][root/amd][pre_trainer][ip-10.21.9.25][rank-0/8][DEBUG] [------arguments.py:1198] :   recompute_granularity ........................... None
[20251218 08:14:38][root/amd][pre_trainer][ip-10.21.9.25][rank-0/8][DEBUG] [------arguments.py:1198] :   recompute_layer_ids ............................. None
[20251218 08:14:38][root/amd][pre_trainer][ip-10.21.9.25][rank-0/8][DEBUG] [------arguments.py:1198] :   recompute_method ................................ None
[20251218 08:14:38][root/amd][pre_trainer][ip-10.21.9.25][rank-0/8][DEBUG] [------arguments.py:1198] :   recompute_num_layers ............................ None
[20251218 08:14:38][root/amd][pre_trainer][ip-10.21.9.25][rank-0/8][DEBUG] [------arguments.py:1198] :   record_memory_history ........................... False
[20251218 08:14:38][root/amd][pre_trainer][ip-10.21.9.25][rank-0/8][DEBUG] [------arguments.py:1198] :   replication ..................................... False
[20251218 08:14:38][root/amd][pre_trainer][ip-10.21.9.25][rank-0/8][DEBUG] [------arguments.py:1198] :   replication_factor .............................. None
[20251218 08:14:38][root/amd][pre_trainer][ip-10.21.9.25][rank-0/8][DEBUG] [------arguments.py:1198] :   replication_jump ................................ None
[20251218 08:14:38][root/amd][pre_trainer][ip-10.21.9.25][rank-0/8][DEBUG] [------arguments.py:1198] :   rerun_mode ...................................... disabled
[20251218 08:14:38][root/amd][pre_trainer][ip-10.21.9.25][rank-0/8][DEBUG] [------arguments.py:1198] :   reset_attention_mask ............................ False
[20251218 08:14:38][root/amd][pre_trainer][ip-10.21.9.25][rank-0/8][DEBUG] [------arguments.py:1198] :   reset_position_ids .............................. False
[20251218 08:14:38][root/amd][pre_trainer][ip-10.21.9.25][rank-0/8][DEBUG] [------arguments.py:1198] :   result_rejected_tracker_filename ................ None
[20251218 08:14:38][root/amd][pre_trainer][ip-10.21.9.25][rank-0/8][DEBUG] [------arguments.py:1198] :   retriever_report_topk_accuracies ................ []
[20251218 08:14:38][root/amd][pre_trainer][ip-10.21.9.25][rank-0/8][DEBUG] [------arguments.py:1198] :   retriever_score_scaling ......................... False
[20251218 08:14:38][root/amd][pre_trainer][ip-10.21.9.25][rank-0/8][DEBUG] [------arguments.py:1198] :   retriever_seq_length ............................ 256
[20251218 08:14:38][root/amd][pre_trainer][ip-10.21.9.25][rank-0/8][DEBUG] [------arguments.py:1198] :   retro_add_retriever ............................. False
[20251218 08:14:38][root/amd][pre_trainer][ip-10.21.9.25][rank-0/8][DEBUG] [------arguments.py:1198] :   retro_attention_gate ............................ 1
[20251218 08:14:38][root/amd][pre_trainer][ip-10.21.9.25][rank-0/8][DEBUG] [------arguments.py:1198] :   retro_cyclic_train_iters ........................ None
[20251218 08:14:38][root/amd][pre_trainer][ip-10.21.9.25][rank-0/8][DEBUG] [------arguments.py:1198] :   retro_encoder_attention_dropout ................. 0.1
[20251218 08:14:38][root/amd][pre_trainer][ip-10.21.9.25][rank-0/8][DEBUG] [------arguments.py:1198] :   retro_encoder_hidden_dropout .................... 0.1
[20251218 08:14:38][root/amd][pre_trainer][ip-10.21.9.25][rank-0/8][DEBUG] [------arguments.py:1198] :   retro_encoder_layers ............................ 2
[20251218 08:14:38][root/amd][pre_trainer][ip-10.21.9.25][rank-0/8][DEBUG] [------arguments.py:1198] :   retro_num_neighbors ............................. 2
[20251218 08:14:38][root/amd][pre_trainer][ip-10.21.9.25][rank-0/8][DEBUG] [------arguments.py:1198] :   retro_num_retrieved_chunks ...................... 2
[20251218 08:14:38][root/amd][pre_trainer][ip-10.21.9.25][rank-0/8][DEBUG] [------arguments.py:1198] :   retro_project_dir ............................... None
[20251218 08:14:38][root/amd][pre_trainer][ip-10.21.9.25][rank-0/8][DEBUG] [------arguments.py:1198] :   retro_verify_neighbor_count ..................... True
[20251218 08:14:38][root/amd][pre_trainer][ip-10.21.9.25][rank-0/8][DEBUG] [------arguments.py:1198] :   rl_calculate_intra_group_similarity ............. False
[20251218 08:14:38][root/amd][pre_trainer][ip-10.21.9.25][rank-0/8][DEBUG] [------arguments.py:1198] :   rl_importance_sampling_truncation_coef .......... None
[20251218 08:14:38][root/amd][pre_trainer][ip-10.21.9.25][rank-0/8][DEBUG] [------arguments.py:1198] :   rl_inference_logprobs_is_correction ............. False
[20251218 08:14:38][root/amd][pre_trainer][ip-10.21.9.25][rank-0/8][DEBUG] [------arguments.py:1198] :   rl_offload_kv_cache_during_training ............. False
[20251218 08:14:38][root/amd][pre_trainer][ip-10.21.9.25][rank-0/8][DEBUG] [------arguments.py:1198] :   rl_offload_optimizer_during_inference ........... False
[20251218 08:14:38][root/amd][pre_trainer][ip-10.21.9.25][rank-0/8][DEBUG] [------arguments.py:1198] :   rl_partial_rollouts ............................. False
[20251218 08:14:38][root/amd][pre_trainer][ip-10.21.9.25][rank-0/8][DEBUG] [------arguments.py:1198] :   rl_prompts_per_eval ............................. 32
[20251218 08:14:38][root/amd][pre_trainer][ip-10.21.9.25][rank-0/8][DEBUG] [------arguments.py:1198] :   rl_remove_kv_cache_during_training .............. False
[20251218 08:14:38][root/amd][pre_trainer][ip-10.21.9.25][rank-0/8][DEBUG] [------arguments.py:1198] :   rl_reset_cuda_graphs ............................ False
[20251218 08:14:38][root/amd][pre_trainer][ip-10.21.9.25][rank-0/8][DEBUG] [------arguments.py:1198] :   rope_scaling_factor ............................. 8.0
[20251218 08:14:38][root/amd][pre_trainer][ip-10.21.9.25][rank-0/8][DEBUG] [------arguments.py:1198] :   rope_type ....................................... None
[20251218 08:14:38][root/amd][pre_trainer][ip-10.21.9.25][rank-0/8][DEBUG] [------arguments.py:1198] :   rotary_base ..................................... 500000
[20251218 08:14:38][root/amd][pre_trainer][ip-10.21.9.25][rank-0/8][DEBUG] [------arguments.py:1198] :   rotary_interleaved .............................. False
[20251218 08:14:38][root/amd][pre_trainer][ip-10.21.9.25][rank-0/8][DEBUG] [------arguments.py:1198] :   rotary_percent .................................. 1.0
[20251218 08:14:38][root/amd][pre_trainer][ip-10.21.9.25][rank-0/8][DEBUG] [------arguments.py:1198] :   rotary_scaling_factor ........................... 40
[20251218 08:14:38][root/amd][pre_trainer][ip-10.21.9.25][rank-0/8][DEBUG] [------arguments.py:1198] :   rotary_seq_len_interpolation_factor ............. None
[20251218 08:14:38][root/amd][pre_trainer][ip-10.21.9.25][rank-0/8][DEBUG] [------arguments.py:1198] :   router_logit_softcapping ........................ None
[20251218 08:14:38][root/amd][pre_trainer][ip-10.21.9.25][rank-0/8][DEBUG] [------arguments.py:1198] :   run_workload_inspector_server ................... False
[20251218 08:14:38][root/amd][pre_trainer][ip-10.21.9.25][rank-0/8][DEBUG] [------arguments.py:1198] :   s3_cache_path ................................... None
[20251218 08:14:38][root/amd][pre_trainer][ip-10.21.9.25][rank-0/8][DEBUG] [------arguments.py:1198] :   sample_rate ..................................... 1.0
[20251218 08:14:38][root/amd][pre_trainer][ip-10.21.9.25][rank-0/8][DEBUG] [------arguments.py:1198] :   save ............................................ /workspace/Primus/output/amd/root/llama3.1_8B-pretrain/checkpoints
[20251218 08:14:38][root/amd][pre_trainer][ip-10.21.9.25][rank-0/8][DEBUG] [------arguments.py:1198] :   save_interval ................................... 20000
[20251218 08:14:38][root/amd][pre_trainer][ip-10.21.9.25][rank-0/8][DEBUG] [------arguments.py:1198] :   save_retain_interval ............................ None
[20251218 08:14:38][root/amd][pre_trainer][ip-10.21.9.25][rank-0/8][DEBUG] [------arguments.py:1198] :   scatter_gather_tensors_in_pipeline .............. True
[20251218 08:14:38][root/amd][pre_trainer][ip-10.21.9.25][rank-0/8][DEBUG] [------arguments.py:1198] :   seed ............................................ 1234
[20251218 08:14:38][root/amd][pre_trainer][ip-10.21.9.25][rank-0/8][DEBUG] [------arguments.py:1198] :   seq_length ...................................... 8192
[20251218 08:14:38][root/amd][pre_trainer][ip-10.21.9.25][rank-0/8][DEBUG] [------arguments.py:1198] :   sequence_parallel ............................... False
[20251218 08:14:38][root/amd][pre_trainer][ip-10.21.9.25][rank-0/8][DEBUG] [------arguments.py:1198] :   sgd_momentum .................................... 0.9
[20251218 08:14:38][root/amd][pre_trainer][ip-10.21.9.25][rank-0/8][DEBUG] [------arguments.py:1198] :   sharp_enabled_group ............................. None
[20251218 08:14:38][root/amd][pre_trainer][ip-10.21.9.25][rank-0/8][DEBUG] [------arguments.py:1198] :   short_seq_prob .................................. 0.1
[20251218 08:14:38][root/amd][pre_trainer][ip-10.21.9.25][rank-0/8][DEBUG] [------arguments.py:1198] :   sink_level ...................................... None
[20251218 08:14:38][root/amd][pre_trainer][ip-10.21.9.25][rank-0/8][DEBUG] [------arguments.py:1198] :   skip_train ...................................... False
[20251218 08:14:38][root/amd][pre_trainer][ip-10.21.9.25][rank-0/8][DEBUG] [------arguments.py:1198] :   skipped_train_samples ........................... 0
[20251218 08:14:38][root/amd][pre_trainer][ip-10.21.9.25][rank-0/8][DEBUG] [------arguments.py:1198] :   spec ............................................ None
[20251218 08:14:38][root/amd][pre_trainer][ip-10.21.9.25][rank-0/8][DEBUG] [------arguments.py:1198] :   split ........................................... None
[20251218 08:14:38][root/amd][pre_trainer][ip-10.21.9.25][rank-0/8][DEBUG] [------arguments.py:1198] :   squared_relu .................................... False
[20251218 08:14:38][root/amd][pre_trainer][ip-10.21.9.25][rank-0/8][DEBUG] [------arguments.py:1198] :   standalone_embedding_stage ...................... False
[20251218 08:14:38][root/amd][pre_trainer][ip-10.21.9.25][rank-0/8][DEBUG] [------arguments.py:1198] :   start_weight_decay .............................. 0.1
[20251218 08:14:38][root/amd][pre_trainer][ip-10.21.9.25][rank-0/8][DEBUG] [------arguments.py:1198] :   stderr_sink_level ............................... DEBUG
[20251218 08:14:38][root/amd][pre_trainer][ip-10.21.9.25][rank-0/8][DEBUG] [------arguments.py:1198] :   straggler_ctrlr_port ............................ 65535
[20251218 08:14:38][root/amd][pre_trainer][ip-10.21.9.25][rank-0/8][DEBUG] [------arguments.py:1198] :   straggler_minmax_count .......................... 1
[20251218 08:14:38][root/amd][pre_trainer][ip-10.21.9.25][rank-0/8][DEBUG] [------arguments.py:1198] :   suggested_communication_unit_size ............... 400000000
[20251218 08:14:38][root/amd][pre_trainer][ip-10.21.9.25][rank-0/8][DEBUG] [------arguments.py:1198] :   swiglu .......................................... True
[20251218 08:14:38][root/amd][pre_trainer][ip-10.21.9.25][rank-0/8][DEBUG] [------arguments.py:1198] :   swin_backbone_type .............................. tiny
[20251218 08:14:38][root/amd][pre_trainer][ip-10.21.9.25][rank-0/8][DEBUG] [------arguments.py:1198] :   te_rng_tracker .................................. False
[20251218 08:14:38][root/amd][pre_trainer][ip-10.21.9.25][rank-0/8][DEBUG] [------arguments.py:1198] :   tensor_model_parallel_size ...................... 1
[20251218 08:14:38][root/amd][pre_trainer][ip-10.21.9.25][rank-0/8][DEBUG] [------arguments.py:1198] :   tensorboard_dir ................................. None
[20251218 08:14:38][root/amd][pre_trainer][ip-10.21.9.25][rank-0/8][DEBUG] [------arguments.py:1198] :   tensorboard_log_interval ........................ 1
[20251218 08:14:38][root/amd][pre_trainer][ip-10.21.9.25][rank-0/8][DEBUG] [------arguments.py:1198] :   tensorboard_queue_size .......................... 1000
[20251218 08:14:38][root/amd][pre_trainer][ip-10.21.9.25][rank-0/8][DEBUG] [------arguments.py:1198] :   test_data_path .................................. None
[20251218 08:14:38][root/amd][pre_trainer][ip-10.21.9.25][rank-0/8][DEBUG] [------arguments.py:1198] :   test_mode ....................................... False
[20251218 08:14:38][root/amd][pre_trainer][ip-10.21.9.25][rank-0/8][DEBUG] [------arguments.py:1198] :   tiktoken_num_special_tokens ..................... 1000
[20251218 08:14:38][root/amd][pre_trainer][ip-10.21.9.25][rank-0/8][DEBUG] [------arguments.py:1198] :   tiktoken_pattern ................................ None
[20251218 08:14:38][root/amd][pre_trainer][ip-10.21.9.25][rank-0/8][DEBUG] [------arguments.py:1198] :   tiktoken_special_tokens ......................... None
[20251218 08:14:38][root/amd][pre_trainer][ip-10.21.9.25][rank-0/8][DEBUG] [------arguments.py:1198] :   timing_log_level ................................ 0
[20251218 08:14:38][root/amd][pre_trainer][ip-10.21.9.25][rank-0/8][DEBUG] [------arguments.py:1198] :   timing_log_option ............................... minmax
[20251218 08:14:38][root/amd][pre_trainer][ip-10.21.9.25][rank-0/8][DEBUG] [------arguments.py:1198] :   titles_data_path ................................ None
[20251218 08:14:38][root/amd][pre_trainer][ip-10.21.9.25][rank-0/8][DEBUG] [------arguments.py:1198] :   tokenizer_model ................................. meta-llama/Llama-3.1-8B
[20251218 08:14:38][root/amd][pre_trainer][ip-10.21.9.25][rank-0/8][DEBUG] [------arguments.py:1198] :   tokenizer_type .................................. Llama3Tokenizer
[20251218 08:14:38][root/amd][pre_trainer][ip-10.21.9.25][rank-0/8][DEBUG] [------arguments.py:1198] :   torch_profiler_record_shapes .................... True
[20251218 08:14:38][root/amd][pre_trainer][ip-10.21.9.25][rank-0/8][DEBUG] [------arguments.py:1198] :   torch_profiler_use_gzip ......................... False
[20251218 08:14:38][root/amd][pre_trainer][ip-10.21.9.25][rank-0/8][DEBUG] [------arguments.py:1198] :   torch_profiler_with_stack ....................... True
[20251218 08:14:38][root/amd][pre_trainer][ip-10.21.9.25][rank-0/8][DEBUG] [------arguments.py:1198] :   tp_comm_bootstrap_backend ....................... nccl
[20251218 08:14:38][root/amd][pre_trainer][ip-10.21.9.25][rank-0/8][DEBUG] [------arguments.py:1198] :   tp_comm_bulk_dgrad .............................. True
[20251218 08:14:38][root/amd][pre_trainer][ip-10.21.9.25][rank-0/8][DEBUG] [------arguments.py:1198] :   tp_comm_bulk_wgrad .............................. True
[20251218 08:14:38][root/amd][pre_trainer][ip-10.21.9.25][rank-0/8][DEBUG] [------arguments.py:1198] :   tp_comm_overlap ................................. False
[20251218 08:14:38][root/amd][pre_trainer][ip-10.21.9.25][rank-0/8][DEBUG] [------arguments.py:1198] :   tp_comm_overlap_ag .............................. True
[20251218 08:14:38][root/amd][pre_trainer][ip-10.21.9.25][rank-0/8][DEBUG] [------arguments.py:1198] :   tp_comm_overlap_cfg ............................. None
[20251218 08:14:38][root/amd][pre_trainer][ip-10.21.9.25][rank-0/8][DEBUG] [------arguments.py:1198] :   tp_comm_overlap_rs .............................. True
[20251218 08:14:38][root/amd][pre_trainer][ip-10.21.9.25][rank-0/8][DEBUG] [------arguments.py:1198] :   tp_comm_overlap_rs_dgrad ........................ False
[20251218 08:14:38][root/amd][pre_trainer][ip-10.21.9.25][rank-0/8][DEBUG] [------arguments.py:1198] :   tp_comm_split_ag ................................ True
[20251218 08:14:38][root/amd][pre_trainer][ip-10.21.9.25][rank-0/8][DEBUG] [------arguments.py:1198] :   tp_comm_split_rs ................................ True
[20251218 08:14:38][root/amd][pre_trainer][ip-10.21.9.25][rank-0/8][DEBUG] [------arguments.py:1198] :   train_data_path ................................. None
[20251218 08:14:38][root/amd][pre_trainer][ip-10.21.9.25][rank-0/8][DEBUG] [------arguments.py:1198] :   train_iters ..................................... 50
[20251218 08:14:38][root/amd][pre_trainer][ip-10.21.9.25][rank-0/8][DEBUG] [------arguments.py:1198] :   train_samples ................................... None
[20251218 08:14:38][root/amd][pre_trainer][ip-10.21.9.25][rank-0/8][DEBUG] [------arguments.py:1198] :   train_sync_interval ............................. None
[20251218 08:14:38][root/amd][pre_trainer][ip-10.21.9.25][rank-0/8][DEBUG] [------arguments.py:1198] :   trainable ....................................... True
[20251218 08:14:38][root/amd][pre_trainer][ip-10.21.9.25][rank-0/8][DEBUG] [------arguments.py:1198] :   transformer_impl ................................ transformer_engine
[20251218 08:14:38][root/amd][pre_trainer][ip-10.21.9.25][rank-0/8][DEBUG] [------arguments.py:1198] :   transformer_pipeline_model_parallel_size ........ 1
[20251218 08:14:38][root/amd][pre_trainer][ip-10.21.9.25][rank-0/8][DEBUG] [------arguments.py:1198] :   trust_remote_code ............................... False
[20251218 08:14:38][root/amd][pre_trainer][ip-10.21.9.25][rank-0/8][DEBUG] [------arguments.py:1198] :   turbo_deepep_num_cu ............................. 32
[20251218 08:14:38][root/amd][pre_trainer][ip-10.21.9.25][rank-0/8][DEBUG] [------arguments.py:1198] :   turbo_deepep_use_comm_stream .................... False
[20251218 08:14:38][root/amd][pre_trainer][ip-10.21.9.25][rank-0/8][DEBUG] [------arguments.py:1198] :   turbo_sync_free_moe_stage ....................... 0
[20251218 08:14:38][root/amd][pre_trainer][ip-10.21.9.25][rank-0/8][DEBUG] [------arguments.py:1198] :   untie_embeddings_and_output_weights ............. True
[20251218 08:14:38][root/amd][pre_trainer][ip-10.21.9.25][rank-0/8][DEBUG] [------arguments.py:1198] :   use_checkpoint_args ............................. False
[20251218 08:14:38][root/amd][pre_trainer][ip-10.21.9.25][rank-0/8][DEBUG] [------arguments.py:1198] :   use_checkpoint_opt_param_scheduler .............. False
[20251218 08:14:38][root/amd][pre_trainer][ip-10.21.9.25][rank-0/8][DEBUG] [------arguments.py:1198] :   use_cpu_initialization .......................... None
[20251218 08:14:38][root/amd][pre_trainer][ip-10.21.9.25][rank-0/8][DEBUG] [------arguments.py:1198] :   use_custom_fsdp ................................. False
[20251218 08:14:38][root/amd][pre_trainer][ip-10.21.9.25][rank-0/8][DEBUG] [------arguments.py:1198] :   use_deprecated_20241209_moe_layer ............... False
[20251218 08:14:38][root/amd][pre_trainer][ip-10.21.9.25][rank-0/8][DEBUG] [------arguments.py:1198] :   use_dist_ckpt ................................... False
[20251218 08:14:38][root/amd][pre_trainer][ip-10.21.9.25][rank-0/8][DEBUG] [------arguments.py:1198] :   use_dist_ckpt_deprecated ........................ False
[20251218 08:14:38][root/amd][pre_trainer][ip-10.21.9.25][rank-0/8][DEBUG] [------arguments.py:1198] :   use_distributed_optimizer ....................... True
[20251218 08:14:38][root/amd][pre_trainer][ip-10.21.9.25][rank-0/8][DEBUG] [------arguments.py:1198] :   use_flash_attn .................................. True
[20251218 08:14:38][root/amd][pre_trainer][ip-10.21.9.25][rank-0/8][DEBUG] [------arguments.py:1198] :   use_legacy_models ............................... False
[20251218 08:14:38][root/amd][pre_trainer][ip-10.21.9.25][rank-0/8][DEBUG] [------arguments.py:1198] :   use_megatron_fsdp ............................... False
[20251218 08:14:38][root/amd][pre_trainer][ip-10.21.9.25][rank-0/8][DEBUG] [------arguments.py:1198] :   use_mp_args_from_checkpoint_args ................ False
[20251218 08:14:38][root/amd][pre_trainer][ip-10.21.9.25][rank-0/8][DEBUG] [------arguments.py:1198] :   use_one_sent_docs ............................... False
[20251218 08:14:38][root/amd][pre_trainer][ip-10.21.9.25][rank-0/8][DEBUG] [------arguments.py:1198] :   use_persistent_ckpt_worker ...................... False
[20251218 08:14:38][root/amd][pre_trainer][ip-10.21.9.25][rank-0/8][DEBUG] [------arguments.py:1198] :   use_precision_aware_optimizer ................... False
[20251218 08:14:38][root/amd][pre_trainer][ip-10.21.9.25][rank-0/8][DEBUG] [------arguments.py:1198] :   use_pytorch_profiler ............................ False
[20251218 08:14:38][root/amd][pre_trainer][ip-10.21.9.25][rank-0/8][DEBUG] [------arguments.py:1198] :   use_ring_exchange_p2p ........................... False
[20251218 08:14:38][root/amd][pre_trainer][ip-10.21.9.25][rank-0/8][DEBUG] [------arguments.py:1198] :   use_rocm_mem_info ............................... False
[20251218 08:14:38][root/amd][pre_trainer][ip-10.21.9.25][rank-0/8][DEBUG] [------arguments.py:1198] :   use_rocm_mem_info_iters ......................... [1, 2]
[20251218 08:14:38][root/amd][pre_trainer][ip-10.21.9.25][rank-0/8][DEBUG] [------arguments.py:1198] :   use_rope_scaling ................................ False
[20251218 08:14:38][root/amd][pre_trainer][ip-10.21.9.25][rank-0/8][DEBUG] [------arguments.py:1198] :   use_rotary_position_embeddings .................. None
[20251218 08:14:38][root/amd][pre_trainer][ip-10.21.9.25][rank-0/8][DEBUG] [------arguments.py:1198] :   use_sharp ....................................... False
[20251218 08:14:38][root/amd][pre_trainer][ip-10.21.9.25][rank-0/8][DEBUG] [------arguments.py:1198] :   use_te_activation_func .......................... False
[20251218 08:14:38][root/amd][pre_trainer][ip-10.21.9.25][rank-0/8][DEBUG] [------arguments.py:1198] :   use_tokenizer_model_from_checkpoint_args ........ True
[20251218 08:14:38][root/amd][pre_trainer][ip-10.21.9.25][rank-0/8][DEBUG] [------arguments.py:1198] :   use_torch_fsdp2 ................................. False
[20251218 08:14:38][root/amd][pre_trainer][ip-10.21.9.25][rank-0/8][DEBUG] [------arguments.py:1198] :   use_torch_optimizer_for_cpu_offload ............. False
[20251218 08:14:38][root/amd][pre_trainer][ip-10.21.9.25][rank-0/8][DEBUG] [------arguments.py:1198] :   use_tp_pp_dp_mapping ............................ False
[20251218 08:14:38][root/amd][pre_trainer][ip-10.21.9.25][rank-0/8][DEBUG] [------arguments.py:1198] :   use_turbo_attention ............................. False
[20251218 08:14:38][root/amd][pre_trainer][ip-10.21.9.25][rank-0/8][DEBUG] [------arguments.py:1198] :   use_turbo_deepep ................................ False
[20251218 08:14:38][root/amd][pre_trainer][ip-10.21.9.25][rank-0/8][DEBUG] [------arguments.py:1198] :   use_turbo_fused_act_with_probs .................. False
[20251218 08:14:38][root/amd][pre_trainer][ip-10.21.9.25][rank-0/8][DEBUG] [------arguments.py:1198] :   use_turbo_grouped_mlp ........................... False
[20251218 08:14:38][root/amd][pre_trainer][ip-10.21.9.25][rank-0/8][DEBUG] [------arguments.py:1198] :   use_turbo_parallel_linear ....................... False
[20251218 08:14:38][root/amd][pre_trainer][ip-10.21.9.25][rank-0/8][DEBUG] [------arguments.py:1198] :   use_turbo_rms_norm .............................. False
[20251218 08:14:38][root/amd][pre_trainer][ip-10.21.9.25][rank-0/8][DEBUG] [------arguments.py:1198] :   v_head_dim ...................................... 128
[20251218 08:14:38][root/amd][pre_trainer][ip-10.21.9.25][rank-0/8][DEBUG] [------arguments.py:1198] :   valid_data_path ................................. None
[20251218 08:14:38][root/amd][pre_trainer][ip-10.21.9.25][rank-0/8][DEBUG] [------arguments.py:1198] :   variable_seq_lengths ............................ False
[20251218 08:14:38][root/amd][pre_trainer][ip-10.21.9.25][rank-0/8][DEBUG] [------arguments.py:1198] :   virtual_pipeline_model_parallel_size ............ None
[20251218 08:14:38][root/amd][pre_trainer][ip-10.21.9.25][rank-0/8][DEBUG] [------arguments.py:1198] :   vision_backbone_type ............................ vit
[20251218 08:14:38][root/amd][pre_trainer][ip-10.21.9.25][rank-0/8][DEBUG] [------arguments.py:1198] :   vision_pretraining .............................. False
[20251218 08:14:38][root/amd][pre_trainer][ip-10.21.9.25][rank-0/8][DEBUG] [------arguments.py:1198] :   vision_pretraining_type ......................... classify
[20251218 08:14:38][root/amd][pre_trainer][ip-10.21.9.25][rank-0/8][DEBUG] [------arguments.py:1198] :   vocab_extra_ids ................................. 0
[20251218 08:14:38][root/amd][pre_trainer][ip-10.21.9.25][rank-0/8][DEBUG] [------arguments.py:1198] :   vocab_file ...................................... None
[20251218 08:14:38][root/amd][pre_trainer][ip-10.21.9.25][rank-0/8][DEBUG] [------arguments.py:1198] :   vocab_size ...................................... None
[20251218 08:14:38][root/amd][pre_trainer][ip-10.21.9.25][rank-0/8][DEBUG] [------arguments.py:1198] :   wandb_entity .................................... None
[20251218 08:14:38][root/amd][pre_trainer][ip-10.21.9.25][rank-0/8][DEBUG] [------arguments.py:1198] :   wandb_exp_name .................................. None
[20251218 08:14:38][root/amd][pre_trainer][ip-10.21.9.25][rank-0/8][DEBUG] [------arguments.py:1198] :   wandb_project ................................... None
[20251218 08:14:38][root/amd][pre_trainer][ip-10.21.9.25][rank-0/8][DEBUG] [------arguments.py:1198] :   wandb_save_dir .................................. None
[20251218 08:14:38][root/amd][pre_trainer][ip-10.21.9.25][rank-0/8][DEBUG] [------arguments.py:1198] :   weight_decay .................................... 0.1
[20251218 08:14:38][root/amd][pre_trainer][ip-10.21.9.25][rank-0/8][DEBUG] [------arguments.py:1198] :   weight_decay_incr_style ......................... constant
[20251218 08:14:38][root/amd][pre_trainer][ip-10.21.9.25][rank-0/8][DEBUG] [------arguments.py:1198] :   wgrad_deferral_limit ............................ 0
[20251218 08:14:38][root/amd][pre_trainer][ip-10.21.9.25][rank-0/8][DEBUG] [------arguments.py:1198] :   world_size ...................................... 8
[20251218 08:14:38][root/amd][pre_trainer][ip-10.21.9.25][rank-0/8][DEBUG] [------arguments.py:1198] :   yaml_cfg ........................................ None
[20251218 08:14:38][root/amd][pre_trainer][ip-10.21.9.25][rank-0/8][DEBUG] [------arguments.py:1198] :   zero_bubble_adaptive_memory_limit_percentile .... 85
[20251218 08:14:38][root/amd][pre_trainer][ip-10.21.9.25][rank-0/8][DEBUG] [------arguments.py:1198] :   zero_bubble_max_pending_backward ................ auto
[20251218 08:14:38][root/amd][pre_trainer][ip-10.21.9.25][rank-0/8][DEBUG] [------arguments.py:1198] :   zero_bubble_pipeline_timers_end_iter ............ 110
[20251218 08:14:38][root/amd][pre_trainer][ip-10.21.9.25][rank-0/8][DEBUG] [------arguments.py:1198] :   zero_bubble_pipeline_timers_start_iter .......... 100
[20251218 08:14:38][root/amd][pre_trainer][ip-10.21.9.25][rank-0/8][DEBUG] [------arguments.py:1198] :   zero_bubble_v_schedule .......................... False
[20251218 08:14:38][root/amd][pre_trainer][ip-10.21.9.25][rank-0/8][DEBUG] [------arguments.py:1198] :   zero_bubble_v_schedule_mem_setup ................ half
[20251218 08:14:38][root/amd][pre_trainer][ip-10.21.9.25][rank-0/8][DEBUG] [------arguments.py:1199] : -------------------- end of arguments ---------------------
[20251218 08:14:38][root/amd][pre_trainer][ip-10.21.9.25][rank-0/8][INFO ] [--------trainer.py:1185] : -monkey patch megatron.training.global_vars._set_wandb_writer...
[20251218 08:14:38][root/amd][pre_trainer][ip-10.21.9.25][rank-0/8][INFO ] [--------trainer.py:1190] : -set_global_variables...
[20251218 08:14:38][root/amd][pre_trainer][ip-10.21.9.25][rank-0/8][INFO ] [--------trainer.py:1192] : -set_primus_global_variables...
[20251218 08:14:38][root/amd][pre_trainer][ip-10.21.9.25][rank-0/8][INFO ] [--------trainer.py:1197] : -build_tokenizer...
[20251218 08:14:38][root/amd][pre_trainer][ip-10.21.9.25][rank-0/8][INFO ] [--------tokenizer.py:40] : -building Llama3Tokenizer tokenizer...
[20251218 08:14:39][root/amd][pre_trainer][ip-10.21.9.25][rank-0/8][DEBUG] [--------tokenizer.py:63] :  > padded vocab (size: 128256) with 0 dummy tokens (new size: 128256)
[20251218 08:14:39][root/amd][pre_trainer][ip-10.21.9.25][rank-0/8][INFO ] [--------trainer.py:1250] : -lazy_mpu_init:     None
[20251218 08:14:39][root/amd][pre_trainer][ip-10.21.9.25][rank-0/8][INFO ] [--------trainer.py:1227] : -initialize_distributed...
[20251218 08:14:39][root/amd][pre_trainer][ip-10.21.9.25][rank-0/8][DEBUG] [------initialize.py:329] : > initializing torch distributed ...
[20251218 08:14:39][root/amd][pre_trainer][ip-10.21.9.25][rank-0/8][DEBUG] [------initialize.py:380] : > initialized tensor model parallel with size 1
[20251218 08:14:39][root/amd][pre_trainer][ip-10.21.9.25][rank-0/8][DEBUG] [------initialize.py:384] : > initialized pipeline model parallel with size 1
[20251218 08:14:39][root/amd][pre_trainer][ip-10.21.9.25][rank-0/8][INFO ] [--------trainer.py:1231] : -seeds:             1234
[20251218 08:14:55][root/amd][pre_trainer][ip-10.21.9.25][rank-0/8][INFO ] [---------trainer.py:761] : time to initialize megatron (seconds): 17.733
[20251218 08:14:55][root/amd][pre_trainer][ip-10.21.9.25][rank-0/8][DEBUG] [-----------utils.py:385] : [after megatron is initialized] datetime: 2025-12-18 08:14:55 
[20251218 08:14:55][root/amd][pre_trainer][ip-10.21.9.25][rank-0/8][INFO ] [---------trainer.py:994] : -setup_model_and_optimizer...
[20251218 08:14:55][root/amd][pre_trainer][ip-10.21.9.25][rank-0/8][WARNING] [trainer.py:243]: MegatronTrainer: patch TESpecProvider to PrimusTurboSpecProvider, `enable_primus_turbo=True` will use PrimusTurbo backend
[20251218 08:14:55][root/amd][pre_trainer][ip-10.21.9.25][rank-0/8][INFO ] [--------trainer.py:1299] : use pt backend...
[20251218 08:14:55][root/amd][pre_trainer][ip-10.21.9.25][rank-0/8][INFO ] [--------trainer.py:1307] : -run get_model
[20251218 08:14:55][root/amd][pre_trainer][ip-10.21.9.25][rank-0/8][DEBUG] [---------pretrain.py:34] : [PrimusPatch] Overriding build_model to disable second DDP construction...
[20251218 08:14:55][root/amd][pre_trainer][ip-10.21.9.25][rank-0/8][DEBUG] [-----------utils.py:385] : building GPT model ...
[20251218 08:14:56][root/amd][pre_trainer][ip-10.21.9.25][rank-0/8][DEBUG] [--------training.py:903] :  > number of parameters on (tensor, pipeline) model parallel rank (0, 0): 8030261248
[20251218 08:14:56][root/amd][pre_trainer][ip-10.21.9.25][rank-0/8][INFO ] [--------trainer.py:1309] : [DistributedDataParallel(
  (module): Float16Module(
    (module): GPTModel(
      (embedding): LanguageModelEmbedding(
        (word_embeddings): VocabParallelEmbedding()
        (embedding_dropout): Dropout(p=0.0, inplace=False)
      )
      (rotary_pos_emb): RotaryEmbedding()
      (decoder): TransformerBlock(
        (layers): ModuleList(
          (0-31): 32 x TransformerLayer(
            (input_layernorm): IdentityOp()
            (self_attention): SelfAttention(
              (core_attention): TEDotProductAttention(
                (flash_attention): FlashAttention()
                (fused_attention): FusedAttention()
                (unfused_attention): UnfusedDotProductAttention(
                  (scale_mask_softmax): FusedScaleMaskSoftmax()
                  (attention_dropout): Dropout(p=0.0, inplace=False)
                )
              )
              (linear_proj): TERowParallelLinear(in_features=4096, out_features=4096, bias=False, TP=1)
              (linear_qkv): TELayerNormColumnParallelLinear(in_features=4096, out_features=6144, bias=False, TP=1)
              (q_layernorm): IdentityOp()
              (k_layernorm): IdentityOp()
            )
            (pre_cross_attn_layernorm): IdentityOp()
            (cross_attention): IdentityOp()
            (cross_attn_bda): IdentityFuncOp()
            (pre_mlp_layernorm): IdentityOp()
            (mlp): MLP(
              (linear_fc1): TELayerNormColumnParallelLinear(in_features=4096, out_features=28672, bias=False, TP=1)
              (linear_fc2): TERowParallelLinear(in_features=14336, out_features=4096, bias=False, TP=1)
            )
          )
        )
        (final_layernorm): RMSNorm()
      )
      (output_layer): ColumnParallelLinear(in_features=4096, out_features=128256, bias=False, TP=1)
    )
  )
)]
[20251218 08:14:56][root/amd][pre_trainer][ip-10.21.9.25][rank-0/8][INFO ] [--------trainer.py:1323] : -run get_megatron_optimizer
[20251218 08:14:56][root/amd][pre_trainer][ip-10.21.9.25][rank-0/8][DEBUG] [-----------utils.py:385] : [after model, optimizer, and learning rate scheduler are built] datetime: 2025-12-18 08:14:56 
[20251218 08:14:56][root/amd][pre_trainer][ip-10.21.9.25][rank-0/8][DEBUG] [-----------utils.py:385] : > building train, validation, and test datasets ...
[20251218 08:14:56][root/amd][pre_trainer][ip-10.21.9.25][rank-0/8][DEBUG] [-----------utils.py:385] :  > datasets target sizes (minimum size):
[20251218 08:14:56][root/amd][pre_trainer][ip-10.21.9.25][rank-0/8][DEBUG] [-----------utils.py:385] :     train:      12800
[20251218 08:14:56][root/amd][pre_trainer][ip-10.21.9.25][rank-0/8][DEBUG] [-----------utils.py:385] :     validation: 0
[20251218 08:14:56][root/amd][pre_trainer][ip-10.21.9.25][rank-0/8][DEBUG] [-----------utils.py:385] :     test:       0
[20251218 08:14:56][root/amd][pre_trainer][ip-10.21.9.25][rank-0/8][INFO ] [--------trainer.py:1111] : > building train, validation, and test datasets for GPT ...
[20251218 08:14:56][root/amd][pre_trainer][ip-10.21.9.25][rank-0/8][INFO ] [--------trainer.py:1119] : > finished creating GPT datasets ...
[20251218 08:14:56][root/amd][pre_trainer][ip-10.21.9.25][rank-0/8][DEBUG] [-----------utils.py:385] : [after dataloaders are built] datetime: 2025-12-18 08:14:56 
[20251218 08:14:56][root/amd][pre_trainer][ip-10.21.9.25][rank-0/8][INFO ] [--------trainer.py:1058] : done with setup ...
[20251218 08:14:57][root/amd][pre_trainer][ip-10.21.9.25][rank-0/8][INFO ] [--------trainer.py:1453] : training ...
[20251218 08:14:57][root/amd][pre_trainer][ip-10.21.9.25][rank-0/8][INFO ] [--------trainer.py:1597] : Setting rerun_state_machine.current_iteration to 0...
[20251218 08:14:57][root/amd][pre_trainer][ip-10.21.9.25][rank-0/8][INFO ] [-----import_utils.py:30] : [Primus][MegatronCompat] Loaded FullyShardedDataParallel from megatron.core.distributed.fsdp.mcore_fsdp_adapter
[20251218 08:14:57][root/amd][pre_trainer][ip-10.21.9.25][rank-0/8][DEBUG] [-----------utils.py:385] : [before the start of training step] datetime: 2025-12-18 08:14:57 
[20251218 08:15:02][root/amd][pre_trainer][ip-10.21.9.25][rank-0/8][WARNING] [fp8_utils.py:156]: WARNING: Primus-Turbo FP8 delayed not work since Primus-Turbo not support delayed scaling..
[20251218 08:15:50][root/amd][pre_trainer][ip-10.21.9.25][rank-0/8][DEBUG] [theoretical_memory_usage.py:137] : Number of parameters in transformer block in billions:  6.98
[20251218 08:15:50][root/amd][pre_trainer][ip-10.21.9.25][rank-0/8][DEBUG] [theoretical_memory_usage.py:146] : Number of parameters in embedding layers in billions: 1.05
[20251218 08:15:50][root/amd][pre_trainer][ip-10.21.9.25][rank-0/8][DEBUG] [theoretical_memory_usage.py:150] : Total number of parameters in billions: 8.03
[20251218 08:15:50][root/amd][pre_trainer][ip-10.21.9.25][rank-0/8][DEBUG] [theoretical_memory_usage.py:163] : Number of parameters in most loaded shard in billions: 8.0305
[20251218 08:15:50][root/amd][pre_trainer][ip-10.21.9.25][rank-0/8][DEBUG] [-----------utils.py:385] : compute_activation_memory_without_sp
[20251218 08:15:50][root/amd][pre_trainer][ip-10.21.9.25][rank-0/8][DEBUG] [theoretical_memory_usage.py:270] : Activation memory footprint per transformer layer (precise, without SP): 2176.0 MB
[20251218 08:15:50][root/amd][pre_trainer][ip-10.21.9.25][rank-0/8][DEBUG] [theoretical_memory_usage.py:362] : Theoretical memory footprints: weight and optimizer=57438.81 MB, activation=77523.73 MB, total=134962.54 MB

[20251218 08:15:50][root/amd][pre_trainer][ip-10.21.9.25][rank-0/8][DEBUG] [-----------utils.py:275] : [Rank 0] (after 1 iterations) memory (MB) | allocated: 70942.72021484375 | max allocated: 136177.58935546875 | reserved: 145672.0 | max reserved: 145672.0
[20251218 08:34:13][root/amd][pre_trainer][ip-10.21.9.25][rank-0/8][DEBUG] [-----------utils.py:385] : [after training is done] datetime: 2025-12-18 08:34:13 
